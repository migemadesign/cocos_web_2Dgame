System.register("chunks:///_virtual/AudioManager.ts",["cc"],(function(o){"use strict";var u,a,i,n,e;return{setters:[function(o){u=o.cclegacy,a=o.log,i=o.assetManager,n=o.AudioClip,e=o.assert}],execute:function(){u._RF.push({},"1cb64Z+NvNOR6Kis8mT2v0o","AudioManager",void 0);var c=o("AudioManager",function(){function o(){}return o.init=function(u){a("Init AudioManager !"),o._audioSource=u},o.isLoadOk=function(){for(var u in o._cachedAudioClipMap)if(null==o._cachedAudioClipMap[u])return!1;return!0},o.playMusic=function(u){var a="mp3/"+u,i=o._cachedAudioClipMap[a];if(i){var n=o._audioSource;n.stop(),n.clip=i,n.play()}},o.stopMusic=function(){o._audioSource.stop()},o.preloadSound=function(u){var a,e="mp3/"+u;e in o._soundName||(o._soundName.push(e),o._cachedAudioClipMap[e]=null,null==(a=i.resources)||a.load(e,n,(function(u,a){u?console.warn(u):o._cachedAudioClipMap[e]=a})))},o.playSound=function(u){var a=o._audioSource;e(a,"AudioManager not inited!"),console.log("AudioManager play sound "+u);var c="mp3/"+u,d=o._cachedAudioClipMap[c];if(d)a.playOneShot(d,1);else{var r;if(c in o._soundName)return;o._soundName.push(c),o._cachedAudioClipMap[c]=null,null==(r=i.resources)||r.load(c,n,(function(u,i){u?console.warn(u):(o._cachedAudioClipMap[c]=i,a.playOneShot(i,1))}))}},o}());c._audioSource=void 0,c._cachedAudioClipMap={},c._soundName=[],u._RF.pop()}}}));

System.register("chunks:///_virtual/Common.ts",["cc"],(function(t){"use strict";var e,n,s,a,i,o,_;return{setters:[function(t){e=t.cclegacy,n=t.find,s=t.Node,a=t.EventTarget,i=t.resources,o=t.TextAsset,_=t.log}],execute:function(){t({EventEnum_Scene:void 0,common_bind_touch_start:function(t,e,a){var i=n(t);i?(i.off(s.EventType.TOUCH_START,e,a),i.on(s.EventType.TOUCH_START,e,a)):console.log("common_bind_touch_start: node not found -> "+t)},common_getEventTarget:function(){null===u&&(u=new a,console.log("new eventTarget"));return u},getST:function(){null===m&&(m=new r,console.log("new store_data"));return m}}),e._RF.push({},"719a0yXeEFASIdKGkdm5XzV","Common",void 0);var h,u=null;!function(t){t[t.Go_Login=1e3]="Go_Login",t[t.Go_GameHome=1001]="Go_GameHome",t[t.Go_Game=1003]="Go_Game",t[t.Go_Info=1008]="Go_Info",t[t.Ground_Event_UpdateGroup=2001]="Ground_Event_UpdateGroup",t[t.GameA_event_SquareTouch=3001]="GameA_event_SquareTouch",t[t.GameB_event_MathButton=3002]="GameB_event_MathButton",t[t.GameC_event_MapButton=3003]="GameC_event_MapButton",t[t.GameD_event_BoxMoveEnd=3004]="GameD_event_BoxMoveEnd"}(h||(h=t("EventEnum_Scene",{})));var c=t("RankData",(function(t,e,n){this.rank=0,this.name="",this.score=0,this.rank=t,this.name=e,this.score=n})),r=function(){function t(){this.isLoadOk=!1,this.Update_Scean=0,this.nowGameSceneName="",this.disGameUpdateObj={},this.play_totle_score=0,this.play_score=0,this.comble_score=0,this.time_num=0,this.myRankData=[],this.play_last_time_m=0,this.play_last_time_s=0,this.play_last_time_ms=0,this.select_Game=1,this.mission_data=[],this.rank_data=[],this.bl_open_test_debug=!1,this.bl_in_test_mode=!1}var e=t.prototype;return e.init=function(){this.Update_Scean=0,this.play_totle_score=18453,"ccg2022.mosasaurs-studio.com"==window.location.hostname&&(this.bl_open_test_debug=!0),this.myRankData=[new c(50,"VIP06",1010),new c(54,"VIP06",1020),new c(53,"VIP06",1030),new c(51,"VIP06",1040),new c(55,"VIP06",1050)],this.myRankData[3].score=0;for(var t=0;t<5;t++)3!=t&&(this.myRankData[3].score+=this.myRankData[t].score);this.load_mission_data(),this.rank_data=[[new c(1,"VIP33",27e3),new c(2,"VIP15",25500),new c(3,"VIP01",24e3),new c(4,"VIP07",22500),new c(5,"VIP03",21e3),new c(6,"VIP08",20500),new c(7,"VIP05",19e3),new c(8,"VIP14",17500),new c(9,"VIP21",16e3)],[new c(1,"VIP33",27e3),new c(2,"VIP15",25500),new c(3,"VIP04",24e3),new c(4,"VIP19",22500),new c(5,"VIP18",21e3),new c(6,"VIP22",20500),new c(7,"VIP13",19e3),new c(8,"VIP27",17500),new c(9,"VIP25",16e3)],[new c(1,"VIP19",25e3),new c(2,"VIP15",22500),new c(3,"VIP33",2e4),new c(4,"VIP07",17500),new c(5,"VIP03",15e3),new c(6,"VIP01",12500),new c(7,"VIP08",1e4),new c(8,"VIP11",7500),new c(9,"VIP05",5e3)],[new c(1,"VIP33",104e3),new c(2,"VIP15",93500),new c(3,"VIP19",92500),new c(4,"VIP26",91e3),new c(5,"VIP03",88500),new c(6,"VIP07",86e3),new c(7,"VIP01",84500),new c(8,"VIP28",82500),new c(9,"VIP11",80500)],[new c(1,"VIP33",3e4),new c(2,"VIP15",28500),new c(3,"VIP03",27e3),new c(4,"VIP19",25500),new c(5,"VIP07",24e3),new c(6,"VIP26",22500),new c(7,"VIP11",21e3),new c(8,"VIP01",20500),new c(9,"VIP28",19e3)]]},e.b64DecodeUnicode=function(t){return decodeURIComponent(Array.prototype.map.call(atob(t),(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.load_mission_data=function(){var t=this;i.load("jms",o,(function(e,n){if(e)console.warn(e);else{for(var s=n.text,a=["!","-",">","<","~"],i=["=","0","A","N","C"],o=0;o<a.length;o++)s=s.split(a[o]).join(i[o]);for(var _=s.split("|"),h=0;h<_.length-1;h++){var u=_[h],c=t.b64DecodeUnicode(u),r=JSON.parse(c);t.mission_data.push(r)}t.isLoadOk=!0,console.log("load_mission_data ok -> "+t.mission_data.length)}}))},e.get_mission_data=function(){var t=[3,0,2,-1,1];return-1==t[this.select_Game-1]?null:this.mission_data[t[this.select_Game-1]]},e.setWin=function(t,e,n){this.time_num=this.get_mission_data().Time/t,this.time_num=Math.round(100*this.time_num)/100,this.play_score=this.get_mission_data().Score.LevelBase,_(this.get_mission_data());for(var s=this.get_mission_data().Score.ComboCount,a=this.get_mission_data().Score.ComboPlus,i=0,o=0;o<s.length&&n>=s[o];o++)i=a[o];this.comble_score=i,this.play_totle_score=this.play_score+this.comble_score,this.myRankData[this.select_Game-1].score<this.play_totle_score&&(this.myRankData[this.select_Game-1].score=this.play_totle_score),this.myRankData[3].score=0;for(var h=0;h<5;h++)3!=h&&(this.myRankData[3].score+=this.myRankData[h].score)},e.get_bl_open_test_debug=function(){return this.bl_open_test_debug},e.getIsInTestMode=function(){return!!this.bl_open_test_debug&&this.bl_in_test_mode},e.switchTestMode=function(){return this.bl_open_test_debug&&(this.bl_in_test_mode=!this.bl_in_test_mode),this.bl_in_test_mode},t}(),m=null;var l=t("CState",(function(t,e,n,s,a){this.state=0,this.state_name="",this.into_func=null,this.update_func=null,this.out_func=null,this.wait_time=-1,this.elapsed_time=0,this.last_into_time=0,this.skip_to_state=-1,this.state=t,this.state_name=e,this.into_func=n.bind(a),this.update_func=s.bind(a)}));t("CFSM",function(){function t(){this.state_map={},this.state=0,this.state_next=-1,this.last_time=0}var e=t.prototype;return e.add_new_state=function(t,e,n,s,a){var i=new l(t,e,n,s,a);this.state_map[i.state]=i},e.set_Next_state=function(t){if(-1==this.state_next){var e=this.state_map[t];return!!e&&(console.log("set_Next_state: "+e.state+"  "+e.state_name),this.state_next=t,!0)}return!1},e.get_state=function(t){return this.state_map[t]},e.get_now_state=function(){return this.state_map[this.state]},e.update=function(){this._state_change(),this._state_update()},e._state_change=function(){if(-1!=this.state_next){var t=this.state_map[this.state];t&&null!=t.out_func&&t.out_func();var e=this.state_map[this.state_next];this.state=this.state_next,this.state_next=-1,null!=e.into_func&&(e.into_func(),e.last_into_time=Date.now()),this.last_time=Date.now()}},e._state_update=function(){var t=this.state_map[this.state];if(t){if(t.wait_time>0){if(Date.now()-this.last_time<t.wait_time)return;this.last_time=Date.now()}t.elapsed_time=Date.now()-t.last_into_time,null!=t.update_func&&t.update_func(),-1!=t.skip_to_state&&this.set_Next_state(t.skip_to_state)}},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/gameA_SquareT.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Common.ts"],(function(e){"use strict";var t,r,n,o,i,u,a,c,s,p;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){i=e.cclegacy,u=e._decorator,a=e.Node,c=e.Component},function(e){s=e.common_getEventTarget,p=e.EventEnum_Scene}],execute:function(){var l,m,f,S,h,g,y;i._RF.push({},"75f9dgpBZtOc6sr6wJ3zpoJ","gameA_SquareT",void 0);var T=u.ccclass,_=u.property;e("gameA_SquareT",(l=T("gameA_SquareT"),m=_({type:Number}),f=_({type:a}),l((g=t((h=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),u=0;u<r;u++)i[u]=arguments[u];return t=e.call.apply(e,[this].concat(i))||this,n(t,"SquareNumber",g,o(t)),n(t,"SquareNode",y,o(t)),t}r(t,e);var i=t.prototype;return i.start=function(){this.node.on(a.EventType.TOUCH_START,this.onTouchStart,this)},i.onTouchStart=function(){s().emit(p.GameA_event_SquareTouch,this.SquareNode,this.SquareNumber)},i.update=function(e){},t}(c)).prototype,"SquareNumber",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y=t(h.prototype,"SquareNode",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=h))||S));i._RF.pop()}}}));

System.register("chunks:///_virtual/gameB_MathButton.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Common.ts"],(function(t){"use strict";var e,i,n,o,r,h,a;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.Node,r=t.Component},function(t){h=t.common_getEventTarget,a=t.EventEnum_Scene}],execute:function(){var c;i._RF.push({},"06c32VcDzZJSrrgWEM7ypkY","gameB_MathButton",void 0);var s=n.ccclass;n.property,t("gameB_MathButton",s("gameB_MathButton")(c=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).blTouchSW=!1,e.hide_last_time=[],e}e(i,t);var n=i.prototype;return n.start=function(){this.blTouchSW=!1;for(var t=0;t<9;t++)this.node.children[t].on(o.EventType.TOUCH_START,this.onTouchStart,this),this.hide_last_time.push(-1)},n.touchSwitch=function(t){this.blTouchSW=t},n.onTouchStart=function(t){if(0!=this.blTouchSW){h().emit(a.GameB_event_MathButton,Number(t.target.name));for(var e=0;e<9;e++)if(this.node.children[e]==t.target){this.hide_last_time[e]=3,this.node.children[e].active=!1;break}}},n.update=function(t){for(var e=0;e<9;e++)this.hide_last_time[e]>0&&(this.hide_last_time[e]-=t,this.hide_last_time[e]<=0&&(this.hide_last_time[e]=-1,this.node.children[e].active=!0))},i}(r))||c);i._RF.pop()}}}));

System.register("chunks:///_virtual/gameC_MapButton.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Common.ts"],(function(t){"use strict";var o,n,i,e,s,h,a,c,u;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,e=t.find,s=t.Node,h=t.Vec2,a=t.Component},function(t){c=t.common_getEventTarget,u=t.EventEnum_Scene}],execute:function(){var r;n._RF.push({},"83931tO4TRFnLYR9mu5D8En","gameC_MapButton",void 0);var v=i.ccclass;i.property,t("gameC_MapButton",v("gameC_MapButton")(r=function(t){function n(){for(var o,n=arguments.length,i=new Array(n),e=0;e<n;e++)i[e]=arguments[e];return(o=t.call.apply(t,[this].concat(i))||this).blTouchSW=!1,o.path_name=[],o.istouch=[],o.basePostion=new h(100,835),o.basePostion_add=125,o}o(n,t);var i=n.prototype;return i.start=function(){this.blTouchSW=!1;for(var t="Canvas/格子/一般格子/方塊_一般",o=0;o<16;o++){var n=t,i="方塊_一般";o>0&&(n=t+"-"+o.toString().padStart(3,"0"),i+="-"+o.toString().padStart(3,"0"));var h=e(n);h.on(s.EventType.TOUCH_START,this.onTouchStart,this),h.on(s.EventType.TOUCH_MOVE,this.onTouchMove,this),h.on(s.EventType.TOUCH_END,this.onTouchEnd,this),h.on(s.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.path_name.push(i),this.istouch.push(!1),0==o&&console.log(h,h.getWorldPosition())}},i.touchSwitch=function(t){this.blTouchSW=t},i.resetTouch=function(){for(var t=0;t<16;t++)this.istouch[t]=!1},i.check_Link=function(t){for(var o=0,n=0;n<16;n++)this.istouch[n]&&o++;if(0==o)return!0;var i=t%4,e=Math.floor(t/4),s=!1;if(i-1>=0){var h=4*e+(i-1);this.istouch[h]&&(s=!0)}if(i+1<=3){var a=4*e+(i+1);this.istouch[a]&&(s=!0)}if(e-1>=0){var c=4*(e-1)+i;this.istouch[c]&&(s=!0)}if(e+1<=3){var u=4*(e+1)+i;this.istouch[u]&&(s=!0)}return 0!=s},i.onTouchMove=function(t){if(0!=this.blTouchSW){var o=t.touch.getUILocation().x-this.basePostion.x,n=this.basePostion.y-t.touch.getUILocation().y,i=Math.floor(o/this.basePostion_add),e=Math.floor(n/this.basePostion_add);i<0&&(i=0),i>3&&(i=3),e<0&&(e=0),e>3&&(e=3);var s=4*e+i;1!=this.istouch[s]&&0!=this.check_Link(s)&&(this.istouch[s]=!0,c().emit(u.GameC_event_MapButton,s))}},i.onTouchStart=function(t){if(0!=this.blTouchSW){var o=this.path_name.indexOf(t.target.name);1!=this.istouch[o]&&0!=this.check_Link(o)&&(this.istouch[o]=!0,c().emit(u.GameC_event_MapButton,o))}},i.onTouchEnd=function(t){0!=this.blTouchSW&&c().emit(u.GameC_event_MapButton,255)},i.update=function(t){},n}(a))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/gameD_ColorButton.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var o,i,l,e,s,h;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,l=t._decorator,e=t.Node,s=t.Sprite,h=t.Component}],execute:function(){var n;i._RF.push({},"41f0ejTrOlD16QS036YQck4","gameD_ColorButton",void 0);var r=l.ccclass;l.property,t("gameD_ColorButton",r("gameD_ColorButton")(n=function(t){function i(){for(var o,i=arguments.length,l=new Array(i),e=0;e<i;e++)l[e]=arguments[e];return(o=t.call.apply(t,[this].concat(l))||this).blTouchSW=!1,o.btn_mask=null,o.blueNode=null,o.yellowNode=null,o.iColor=0,o.last_time=0,o.switch_fill=0,o.blColorSwitch=!1,o}o(i,t);var l=i.prototype;return l.start=function(){this.blTouchSW=!1,this.btn_mask=this.node.getChildByName("Mask"),this.blueNode=this.node.getChildByName("Blue"),this.yellowNode=this.node.getChildByName("Yellow"),this.set_iColor(0),this.btn_mask.on(e.EventType.TOUCH_START,this.onTouchStart,this)},l.touchSwitch=function(t){this.blTouchSW=t},l.set_iColor=function(t){this.iColor=t,this.blueNode.active=!0,this.yellowNode.active=!0;var o=this.yellowNode.getComponent(s);0==this.iColor?o.fillRange=0:o.fillRange=1},l.switchColor=function(){this.switch_fill=0,this.last_time=Date.now(),this.blColorSwitch=!0},l.onTouchStart=function(t){0!=this.blTouchSW&&1!=this.blColorSwitch&&this.switchColor()},l.update=function(t){if(1==this.blColorSwitch&&Date.now()-this.last_time>=33){this.last_time=Date.now(),this.switch_fill+=.2;var o=this.yellowNode.getComponent(s);this.switch_fill>=1?(this.blColorSwitch=!1,this.set_iColor(0==this.iColor?1:0)):0==this.iColor?o.fillRange=0-this.switch_fill:o.fillRange=1-this.switch_fill}},i}(h))||n);i._RF.pop()}}}));

System.register("chunks:///_virtual/gameD_DiamondBox.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Common.ts","./SpriteFrameManager.ts","./gameD_ColorButton.ts"],(function(t){"use strict";var i,e,o,n,s,r,h,a,p,_,l,m,g,c;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,r=t._decorator,h=t.Vec2,a=t.Sprite,p=t.Color,_=t.Component},function(t){l=t.common_getEventTarget,m=t.EventEnum_Scene},function(t){g=t.SpriteFrameManager},function(t){c=t.gameD_ColorButton}],execute:function(){var u,f,D,d,b,v,x;s._RF.push({},"fdfc0t8amBE1a9DRuF9oGz0","gameD_DiamondBox",void 0);var y=r.ccclass,C=r.property;t("gameD_DiamondBox",(u=y("gameD_DiamondBox"),f=C({type:c}),D=C({type:c}),u((v=i((b=function(t){function i(){for(var i,e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return i=t.call.apply(t,[this].concat(s))||this,o(i,"right_btn",v,n(i)),o(i,"left_btn",x,n(i)),i.iBoxID=0,i.iRL=0,i.iUB=0,i.Postion_Right_Up=new h(120,440),i.Postion_Right_Down=new h(120,-440),i.Postion_Left_Up=new h(-120,440),i.Postion_Left_Down=new h(-120,-440),i.last_time=0,i.iColor=0,i.step=0,i.blMoveFast=!1,i.iRight=1,i}e(i,t);var s=i.prototype;return s.start=function(){},s.init=function(t,i,e,o,n){this.iBoxID=t,this.iColor=i,this.iRL=e,this.iUB=o,this.blMoveFast=n;var s,r=0;0==e&&0==o?(s=this.Postion_Right_Up.x,r=this.Postion_Right_Up.y):0==e&&1==o?(s=this.Postion_Right_Down.x,r=this.Postion_Right_Down.y):1==e&&0==o?(s=this.Postion_Left_Up.x,r=this.Postion_Left_Up.y):1==e&&1==o&&(s=this.Postion_Left_Down.x,r=this.Postion_Left_Down.y),this.node.setPosition(s,r),this.step=0,0==this.iColor?this.node.getComponent(a).spriteFrame=g.getSpriteFrame("b_box"):this.node.getComponent(a).spriteFrame=g.getSpriteFrame("y_box"),this.node.active=!0},s.move=function(){if(0==this.step){var t=10;1==this.blMoveFast&&(t=15);var i=this.node.getPosition().y;0==this.iUB?(i-=t)<=2&&(i=2,this.step=1):(i+=t)>=2&&(i=2,this.step=1),this.node.setPosition(this.node.getPosition().x,i),1==this.step&&(this.iRight=1,0==this.iRL?this.iColor==this.right_btn.iColor&&(this.iRight=0):this.iColor==this.left_btn.iColor&&(this.iRight=0),0==this.iColor?0==this.iRight?this.node.getComponent(a).spriteFrame=g.getSpriteFrame("b_box_right"):this.node.getComponent(a).spriteFrame=g.getSpriteFrame("b_box_err"):0==this.iRight?this.node.getComponent(a).spriteFrame=g.getSpriteFrame("y_box_right"):this.node.getComponent(a).spriteFrame=g.getSpriteFrame("y_box_err"),l().emit(m.GameD_event_BoxMoveEnd,this.iRight,this.iBoxID))}},s.update=function(t){if(0==this.step)Date.now()-this.last_time>=33&&(this.move(),this.last_time=Date.now());else if(1==this.step){var i=(Date.now()-this.last_time)/33,e=.06*i+1;0==this.iRight&&this.node.setScale(e,e),this.node.getComponent(a).color=new p(255,255,255,255-20*i),i>=10&&(this.step=2,this.node.active=!1,l().emit(m.GameD_event_BoxMoveEnd,2,this.iBoxID))}},i}(_)).prototype,"right_btn",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=i(b.prototype,"left_btn",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=b))||d));s._RF.pop()}}}));

System.register("chunks:///_virtual/ground_t.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Common.ts","./AudioManager.ts"],(function(e){"use strict";var t,s,n,i,a,o,h,l,r,d,u;return{setters:[function(e){t=e.inheritsLoose},function(e){s=e.cclegacy,n=e._decorator,i=e.find,a=e.instantiate,o=e.Node,h=e.Component},function(e){l=e.getST,r=e.common_getEventTarget,d=e.EventEnum_Scene},function(e){u=e.AudioManager}],execute:function(){var _;s._RF.push({},"a5478oHo5hOabDqUaFaUuea","ground_t",void 0);var g=n.ccclass;n.property,e("ground_t",g("ground_t")(_=function(e){function s(){for(var t,s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).wait_time=0,t.spNodes=[],t.magic_circle=null,t.str_sp_path=["Canvas/ground/btn_event_Mask/ground/01/spriteFrame","Canvas/ground/btn_event_Mask/ground/01/spriteFrame-001","Canvas/ground/btn_event_Mask/ground/01/spriteFrame-002","Canvas/ground/btn_event_Mask/ground/01/spriteFrame-003","Canvas/ground/btn_event_Mask/ground/01/spriteFrame-004"],t.str_sp_name=["spriteFrame","spriteFrame-001","spriteFrame-002","spriteFrame-003","spriteFrame-004"],t.s02=null,t.sp_step=0,t.base_spNowY=0,t.base_groundY=0,t.add_eulerAnglesY=0,t.newPath=[[3,2,4,1,0],[2,3,4,1,0],[2,3,1,4,0],[1,2,3,0,4],[1,2,3,0,4],[1,2,0,4,3],[0,1,4,3,2],[0,1,4,3,2],[0,4,1,3,2],[4,0,3,1,2],[4,3,0,2,1],[3,2,4,1,0]],t.spBaseAngle=[0,72,144,216,288],t.itouchMove=0,t.blTouch=!1,t.blMove=!1,t.itouch_bk_add_eulerAnglesY=0,t.to_endY=-1,t.to_addY=0,t.lastMoved=0,t.blCanTouch=!0,t}t(s,e);var n=s.prototype;return n.start=function(){console.log(this.node.name+" start");for(var e=0;e<this.str_sp_path.length;e++)this.spNodes.push(i(this.str_sp_path[e]));this.magic_circle=a(i("Canvas/ground/btn_event_Mask/ground/01/magic_circle")),i("Canvas/ground/btn_event_Mask/ground/01").active=!1,this.s02=i("Canvas/ground/btn_event_Mask/ground/02"),this.base_spNowY=this.spNodes[0].eulerAngles.y,this.base_groundY=this.node.eulerAngles.y,this.spNodes[0].scale;var t=l().select_Game;this.add_eulerAnglesY=360-this.spBaseAngle[t-1],360==this.add_eulerAnglesY&&(this.add_eulerAnglesY=0),r().emit(d.Ground_Event_UpdateGroup,t),this.sp_update(this.add_eulerAnglesY);var s=i("Canvas/ground/btn_event_Mask");s.on(o.EventType.TOUCH_MOVE,this.onEventMove,this),s.on(o.EventType.TOUCH_START,this.onEventStart,this),s.on(o.EventType.TOUCH_END,this.onEventEnd,this),s.on(o.EventType.TOUCH_CANCEL,this.onEventEnd,this),this.enableTouch()},n.onEventStart=function(e){0!=this.blCanTouch&&(this.blTouch=!0,this.itouch_bk_add_eulerAnglesY=this.add_eulerAnglesY)},n.onBookEventEnd=function(e){if(0!=this.blCanTouch&&1!=this.blMove){u.playSound("UI_click");var t=this.str_sp_name.indexOf(e.target.name)+1;console.log("onBookEventEnd "+t,e.target.name),this.to_endY=Math.floor(360-this.spBaseAngle[t-1]),this.to_endY>=360&&(this.to_endY-=360),console.log(t,this.to_endY),this.add_eulerAnglesY=Math.floor(this.add_eulerAnglesY),this.to_endY!=this.add_eulerAnglesY&&(this.to_endY>this.add_eulerAnglesY?this.to_addY=1:this.to_addY=-1)}},n.onEventEnd=function(e){if(0!=this.blCanTouch){this.blTouch=!1,this.blMove=!1;var t=e.touch.getLocation().x-e.touch.getStartLocation().x;if(t<3&&t>-3)this.add_eulerAnglesY=this.itouch_bk_add_eulerAnglesY;else{var s=-1,n=-1,i=-1,a=-1;if(this.to_addY>0){i=360,a=360;for(var o=0;o<this.spBaseAngle.length;o++){var h=this.spBaseAngle[o]-this.add_eulerAnglesY;h>=0&&h<i&&(i=h,s=o),this.spBaseAngle[o]<a&&(a=this.spBaseAngle[o],n=o)}-1==s&&(s=n)}else{i=360,a=0;for(var l=0;l<this.spBaseAngle.length;l++){var r=this.add_eulerAnglesY-this.spBaseAngle[l];r>=0&&r<i&&(i=r,s=l),this.spBaseAngle[l]>a&&(a=this.spBaseAngle[l],n=l)}-1==s&&(s=n)}this.to_endY=Math.floor(this.spBaseAngle[s]),this.add_eulerAnglesY=Math.floor(this.add_eulerAnglesY),console.log("iPos:"+s),console.log("to_endY:"+this.to_endY),console.log("add_eulerAnglesY:"+this.add_eulerAnglesY),console.log("to_addY:"+this.to_addY)}}},n.onEventMove=function(e){if(0!=this.blCanTouch){var t=e.touch.getLocation().x-e.touch.getStartLocation().x;this.itouchMove=t,0==this.blMove&&(t>3||t<-3)&&(this.blMove=!0),this.add_eulerAnglesY=this.itouch_bk_add_eulerAnglesY+this.itouchMove/2,this.add_eulerAnglesY>=360?this.add_eulerAnglesY-=360:this.add_eulerAnglesY<0&&(this.add_eulerAnglesY+=360),e.touch.getLocation().x-this.lastMoved>0?this.to_addY=1:this.to_addY=-1,this.lastMoved=e.touch.getLocation().x}},n.enableTouch=function(){this.blCanTouch=!0},n.disableTouch=function(){this.blCanTouch=!1},n.getScaleByeulerAnglesY=function(e){return e>=360?e-=360:e<0&&(e+=360),e>180&&(e=360-e),.6+(180-e)/180*.4},n.sp_update=function(e){var t=Math.floor(e/30)+1;if(t!=this.sp_step){var s=this.sp_step;if(this.sp_step=t,0==this.s02.children.length)for(var n=0;n<this.newPath[t-1].length;n++){0==n&&(this.magic_circle.active=!0,this.s02.addChild(this.magic_circle));var i=a(this.spNodes[this.newPath[t-1][n]]);i.on(o.EventType.TOUCH_END,this.onBookEventEnd,this),i.active=!0,this.s02.addChild(i)}else{var h=[];this.s02.removeChild(this.magic_circle);for(var l=0;l<5;l++)for(var r=0;r<5;r++)if(this.newPath[s-1][r]==l){h.push(this.s02.children[r]);break}this.s02.removeAllChildren();for(var d=0;d<5;d++)0==d&&this.s02.addChild(this.magic_circle),this.s02.addChild(h[this.newPath[t-1][d]])}}},n.groundUpdate=function(){var e=this.node.eulerAngles.clone();e.y=this.base_groundY+this.add_eulerAnglesY,e.y>=360&&(e.y-=360),this.node.setRotationFromEuler(e);var t=this.base_spNowY-this.add_eulerAnglesY;t<0&&(t+=360),this.sp_update(this.add_eulerAnglesY);for(var s=[],n=0;n<this.s02.children.length;n++)this.s02.children[n]!=this.magic_circle&&s.push(this.s02.children[n]);for(var i=0;i<s.length;i++){var a=s[i].eulerAngles.clone();a.y=t,s[i].setRotationFromEuler(a);var o=this.newPath[this.sp_step-1][i],h=this.spBaseAngle[o]+this.add_eulerAnglesY,l=.004*this.getScaleByeulerAnglesY(h),r=s[i].scale.clone();r.x=l,r.y=l,s[i].setScale(r)}},n.update=function(e){if(this.wait_time+=1e3*e,this.wait_time>=33){if(this.wait_time=0,0==this.blTouch&&-1!=this.to_endY){if(this.add_eulerAnglesY==this.to_endY){this.to_endY=-1;var t=360-this.add_eulerAnglesY;t>=360&&(t-=360);var s=this.spBaseAngle.indexOf(t);r().emit(d.Ground_Event_UpdateGroup,s+1)}this.add_eulerAnglesY+=3*this.to_addY;var n=this.to_endY-this.add_eulerAnglesY;n<3&&n>-3&&(this.add_eulerAnglesY=this.to_endY),this.add_eulerAnglesY>=360?this.add_eulerAnglesY-=360:this.add_eulerAnglesY<0&&(this.add_eulerAnglesY+=360)}this.groundUpdate()}},s}(h))||_);s._RF.pop()}}}));

System.register("chunks:///_virtual/gtool_start_time.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,i,a,s,o,r,n,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,a=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){o=t.cclegacy,r=t._decorator,n=t.Label,l=t.Component}],execute:function(){var _,h,u,c,m,p,b;o._RF.push({},"c6438oIZYdDVJ9r2PNap0JO","gtool_start_time",void 0);var d=r.ccclass,f=r.property;t("gtool_start_time",(_=d("gtool_start_time"),h=f({type:Number}),u=f({type:n}),_((p=e((m=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o))||this,a(e,"last_time_sec",p,s(e)),a(e,"time_lable",b,s(e)),e._now_last_time=0,e.last_timestamp=0,e.blTimesUP=!1,e.strPath=["超能學習_1","超能學習_2","超能學習_3"],e.numberNode=[],e}i(e,t);var o=e.prototype;return o.start=function(){this.switchShow(!0)},o.switchShow=function(t){if(t){this.numberNode=[];for(var e=0;e<this.strPath.length;e++){var i=this.node.getChildByPath(this.strPath[e]);i&&(this.numberNode.push(i),i.active=!1)}this._now_last_time=Date.now()+1e3*this.last_time_sec,this.update_time_lable(),this.blTimesUP=!1,this.node.active=!0,this.time_lable&&(this.time_lable.node.active=!1)}else this._now_last_time=Date.now()},o.update_time_lable=function(){if(null!=this.time_lable&&0!=this.numberNode.length){var t=this._now_last_time-Date.now();t<=0&&(t=0);var e=Math.floor(t/1e3);if(e>=0&&e<3&&0==this.numberNode[e].active){for(var i=0;i<this.numberNode.length;i++)this.numberNode[i].active=!1;this.numberNode[e].active=!0}}},o.update=function(t){Date.now()-this.last_timestamp<33||(this.last_timestamp=Date.now(),this.update_time_lable(),this._now_last_time-Date.now()<=0&&(this.blTimesUP=!0))},e}(l)).prototype,"last_time_sec",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),b=e(m.prototype,"time_lable",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=m))||c));o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AudioManager.ts","./Common.ts","./Proc_A_scene.ts","./Proc_B_scene.ts","./Proc_C_scene.ts","./Proc_D_scene.ts","./Proc_GameHome.ts","./Proc_Info.ts","./Proc_Login.ts","./Proc_R_scene.ts","./SpriteFrameManager.ts","./gameA_SquareT.ts","./gameB_MathButton.ts","./gameC_MapButton.ts","./gameD_ColorButton.ts","./gameD_DiamondBox.ts","./ground_t.ts","./gtool_start_time.ts","./main.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/main.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Common.ts","./AudioManager.ts","./SpriteFrameManager.ts","./Proc_Login.ts","./Proc_GameHome.ts","./Proc_A_scene.ts","./Proc_B_scene.ts","./Proc_C_scene.ts","./Proc_D_scene.ts","./Proc_R_scene.ts","./Proc_Info.ts"],(function(e){"use strict";var o,n,t,i,a,c,r,_,s,m,u,g,d,l,p,f,h,S,b,G,y,P,v;return{setters:[function(e){o=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,c=e._decorator,r=e.AudioSource,_=e.game,s=e.director,m=e.Component},function(e){u=e.getST,g=e.common_getEventTarget,d=e.EventEnum_Scene},function(e){l=e.AudioManager},function(e){p=e.SpriteFrameManager},function(e){f=e.getProc_Login},function(e){h=e.getProc_GameHome},function(e){S=e.getProc_A_scene},function(e){b=e.getProc_B_scene},function(e){G=e.getProc_C_scene},function(e){y=e.getProc_D_scene},function(e){P=e.getProc_R_scene},function(e){v=e.getProc_Info}],execute:function(){var U,L,w,H,I,j,k;a._RF.push({},"61bbd2d/tJBmLNEOymAeuuH","main",void 0);var A=c.ccclass,O=c.property;e("main",(U=A("main"),L=O({type:String}),w=O(r),U((j=o((I=function(e){function o(){for(var o,n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return o=e.call.apply(e,[this].concat(a))||this,t(o,"playname",j,i(o)),t(o,"_audioSource",k,i(o)),o}n(o,e);var a=o.prototype;return a.onLoad=function(){console.log("main onLoad"),u().init();var e=this.node;_.addPersistRootNode(e),g().on(d.Go_GameHome,this.go_GameHome,this),g().on(d.Go_Login,this.go_Login,this),g().on(d.Go_Game,this.go_Game,this),g().on(d.Go_Info,this.go_Info,this);var o=this.node.getComponent(r);this._audioSource=o,l.init(this._audioSource);for(var n=["gh_mis_1_1","gh_mis_2_1","gh_mis_3_1","gh_mis_4_1","gh_mis_5_1","gh_mis_book_1","gh_mis_book_2","gh_mis_book_3","gh_mis_book_4","gh_mis_book_5","y_box","y_box_right","y_box_err","b_box","b_box_right","b_box_err"],t=0;t<n.length;t++)p.preloadSpriteFrame(n[t]);for(var i=["result01","answer01","answer02","UI_click","countdown01"],a=["bgm01","bgm02"],c=0;c<i.length;c++)l.preloadSound(i[c]);for(var s=0;s<a.length;s++)l.preloadSound(a[s]);u().disGameUpdateObj.CognitionScene=S(),u().disGameUpdateObj.MathScene=b(),u().disGameUpdateObj.MemoryScene=G(),u().disGameUpdateObj.Rankings=P(),u().disGameUpdateObj.AttentionScene=y()},a.start=function(){console.log("main start"),console.log(this.playname),u().Update_Scean=0,f().init()},a.update=function(e){f().isRunning&&f().update(),u().Update_Scean>0&&u().disGameUpdateObj[u().nowGameSceneName].update()},a.go_GameHome=function(){console.log("go_GameHome"),s.loadScene("GameHome",(function(){u().Update_Scean=0,h().init()}))},a.go_Login=function(){console.log("go_Login"),s.loadScene("Loading",(function(){u().Update_Scean=0,f().init()}))},a.go_Game=function(){u().nowGameSceneName=h().getGameSceneName(),s.loadScene(u().nowGameSceneName,(function(){u().disGameUpdateObj[u().nowGameSceneName].init(),u().Update_Scean=1}))},a.go_Info=function(){console.log("go_Info"),s.loadScene("Info",(function(){u().Update_Scean=0,v().init()}))},o}(m)).prototype,"playname",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),k=o(I.prototype,"_audioSource",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=I))||H));a._RF.pop()}}}));

System.register("chunks:///_virtual/Proc_A_scene.ts",["cc","./Common.ts","./AudioManager.ts","./gtool_start_time.ts"],(function(t){"use strict";var s,i,e,n,a,o,r,_,h,u,l,c,m,d,p;return{setters:[function(t){s=t.cclegacy,i=t.find,e=t.Node,n=t.log,a=t.Label,o=t.RichText,r=t.Sprite,_=t.instantiate,h=t.Color},function(t){u=t.CFSM,l=t.getST,c=t.common_getEventTarget,m=t.EventEnum_Scene},function(t){d=t.AudioManager},function(t){p=t.gtool_start_time}],execute:function(){var v;t("getProc_A_scene",(function(){null===q&&(q=new g,console.log("new Proc_A_scene"));return q})),s._RF.push({},"1f887NG4SNHEIOeRlVYJ+dQ","Proc_A_scene",void 0),function(t){t[t.st_none=100]="st_none",t[t.st_init=101]="st_init",t[t.st_tutorial=102]="st_tutorial",t[t.st_into_animation=103]="st_into_animation",t[t.st_nextMission=104]="st_nextMission",t[t.st_play_input=105]="st_play_input",t[t.st_show_result=106]="st_show_result",t[t.st_show_mission_win=107]="st_show_mission_win",t[t.st_show_mission_err=108]="st_show_mission_err",t[t.st_show_score=109]="st_show_score",t[t.st_timeup_animation=110]="st_timeup_animation",t[t.st_end=111]="st_end"}(v||(v={}));var S=function(){function t(){this.one_quare_aroundline=[[1,13,16,4],[2,16,19,5],[3,19,22,6],[4,17,14,7],[5,17,20,8],[6,23,20,9],[7,15,18,10],[8,21,18,11],[9,21,24,12]],this.node_line=[],this.node_line_path=["Canvas/answer_line/01","Canvas/answer_line/02","Canvas/answer_line/03","Canvas/answer_line/04","Canvas/answer_line/05","Canvas/answer_line/06","Canvas/answer_line/07","Canvas/answer_line/08","Canvas/answer_line/09","Canvas/answer_line/10","Canvas/answer_line/11","Canvas/answer_line/12","Canvas/answer_line/13","Canvas/answer_line/14","Canvas/answer_line/15","Canvas/answer_line/16","Canvas/answer_line/17","Canvas/answer_line/18","Canvas/answer_line/19","Canvas/answer_line/20","Canvas/answer_line/21","Canvas/answer_line/22","Canvas/answer_line/23","Canvas/answer_line/24"]}var s=t.prototype;return s.init=function(){for(var t=0;t<this.node_line_path.length;t++)this.node_line[t]=i(this.node_line_path[t]),this.node_line[t].active=!1},s.show_line=function(t){for(var s={},i=0;i<24;i++)s[i]=0;for(var e=0;e<t.length;e++)if(0!=t[e])for(var n=0;n<4;n++)s[this.one_quare_aroundline[e][n]-1]++;for(var a=0;a<24;a++)1==s[a]?this.node_line[a].active=!0:this.node_line[a].active=!1},s.hide_line=function(){for(var t=0;t<24;t++)this.node_line[t].active=!1},t}(),f=function(){function t(){this.unitSet=[]}var s=t.prototype;return s.init=function(t){for(var s=0;s<14;s++){for(var i=t["Unit_"+(s+1).toString().padStart(2,"0")].shape,e=[],n=0;n<3;n++)e.push(i.Row1[n]);for(var a=0;a<3;a++)e.push(i.Row2[a]);for(var o=0;o<3;o++)e.push(i.Row3[o]);this.unitSet.push(e)}},s.squareData_add=function(t,s){for(var i=0;i<9;i++)s[i]>0&&(t[i]=s[i])},s.getMapData=function(t,s,i){for(var e=[],n=this.unitSet[t-1],a=!1,o=[[0,0,0],[0,0,0],[0,0,0]],r=[[0,0,0],[0,0,0],[0,0,0]],_=0;_<9;_++)o[Math.floor(_%3)][Math.floor(_/3)]=n[_];for(var h=0;h<9;h++){var u=Math.floor(h%3)+s,l=Math.floor(h/3)+i;if(u>2||l>2){if(0!=o[Math.floor(h%3)][Math.floor(h/3)]){a=!0;break}}else r[u][l]=o[Math.floor(h%3)][Math.floor(h/3)]}if(a)return null;for(var c=0;c<9;c++){var m=Math.floor(c%3),d=Math.floor(c/3);e.push(r[m][d])}return e},s.check_overlap=function(t,s){for(var i=0;i<9;i++)if(0!=t[i]&&0!=s[i])return!0;return!1},s.check_equal=function(t,s){for(var i=0;i<9;i++)if(t[i]!=s[i])return!1;return!0},t}(),w=function(){function t(){this.SquareNumber=0,this.node_square=null,this.PosX=0,this.PosY=0,this.mapdata=[0,0,0,0,0,0,0,0,0],this.cSquareData=null,this.allSquare=null,this.blMoveDown=!1,this.blBreakIn=!1,this.breakStep=0}var s=t.prototype;return s.init=function(t,s){this.SquareNumber=t,this.cSquareData=new f,this.cSquareData.unitSet=s,this.node_square=_(i("Canvas/square/base/"+t.toString().padStart(2,"0"))),i("Canvas/square/clone").addChild(this.node_square),this.node_square.active=!0,this.move(0,0)},s.setAllSquare=function(t){this.allSquare=t},s.check_moveTo=function(t,s){var i=this.cSquareData.getMapData(this.SquareNumber,t,s);return null!=i&&!this.check_overlap(i)},s.check_overlap=function(t){var s=[0,0,0,0,0,0,0,0,0];if(this.allSquare)for(var i=0;i<this.allSquare.length;i++)if(this.allSquare[i]!=this){var e=this.allSquare[i];this.cSquareData.squareData_add(s,this.cSquareData.getMapData(e.SquareNumber,e.PosX,e.PosY))}return this.cSquareData.check_overlap(s,t)},s.move=function(t,s){var i=this.cSquareData.getMapData(this.SquareNumber,t,s);if(null==i)return!1;this.PosX=t,this.PosY=s,this.node_square.setPosition(190*t,-190*s);for(var e=0;e<i.length;e++)this.mapdata[e]=i[e]},s.moveDown=function(){return!this.blMoveDown&&(!!this.check_moveTo(this.PosX,this.PosY+1)&&(this.blMoveDown=!0,!0))},s.breakIn=function(){this.blBreakIn=!0,this.breakStep=0},s.show_error=function(){for(var t=0;t<this.node_square.children[0].children.length;t++){this.node_square.children[0].children[t].getComponent(r).color=new h(255,100,100)}},s.show_win=function(){for(var t=0;t<this.node_square.children[0].children.length;t++){this.node_square.children[0].children[t].getComponent(r).color=new h(100,255,100)}},s.distory=function(){this.blMoveDown=!1,i("Canvas/square/clone").removeChild(this.node_square),this.node_square.destroy(),this.node_square=null;var t=this.allSquare.indexOf(this);this.allSquare.splice(t,1)},s.update=function(){if(this.blMoveDown){var t=this.node_square.getPosition().x,s=this.node_square.getPosition().y-24;this.node_square.setPosition(t,s),-190*(this.PosY+1)>=s&&(this.blMoveDown=!1,this.move(this.PosX,this.PosY+1))}if(this.blBreakIn){this.breakStep++;for(var i=0;i<this.node_square.children[0].children.length;i++){var e=this.node_square.children[0].children[i];if(this.breakStep<5)e.setScale(1+this.breakStep/20,1+this.breakStep/20);else{var n=1.2-(this.breakStep-4)/20;e.setScale(n,n)}e.getComponent(r).color=new h(255,255,255,255-10*this.breakStep)}10==this.breakStep&&(this.blBreakIn=!1,this.distory())}},t}(),g=function(){function t(){this.last_timestamp=0,this.cFSM=null,this.md=null,this.mission=0,this.right_mission=0,this.error_mission=0,this.ComboCount=0,this.last_is_right=!1,this.arrQuestionNumber=[],this.cSquareline=null,this.cSquares=[],this.cSquareData=null,this.answerMapData=null,this.answer_no_X=null,this.node_StartTime=null,this.node_TimesUp=null,this.node_score_panle=null,this.play_last_time=0,this.strTutorialPath=["Canvas/tutorial/遊戲說明_01","Canvas/tutorial/遊戲說明_02","Canvas/tutorial/遊戲說明_03"],this.blPlay10TimesSound=!1}var s=t.prototype;return s.init=function(){this.cFSM=new u,this.add_FSM_state(),this.cFSM.set_Next_state(v.st_init),this.last_timestamp=Date.now(),this.md=l().get_mission_data(),this.mission=0,this.right_mission=0,this.ComboCount=0,this.last_is_right=!1,this.cSquareline=new S,this.cSquareline.init(),this.cSquares=[],i("Canvas/square/clone").removeAllChildren(),i("Canvas/tutorial").active=!1,this.node_StartTime=i("Canvas/start"),this.node_StartTime.active=!1,this.node_TimesUp=i("Canvas/timesup"),this.node_TimesUp.active=!1,this.node_score_panle=i("Canvas/score_panle"),this.node_score_panle.active=!1,this.cSquareData=new f,this.cSquareData.init(this.md.QuestionUnitSet),this.arrQuestionNumber=[],c().on(m.GameA_event_SquareTouch,this.gameA_event_SquareTouch,this),i("Canvas/返回").once(e.EventType.TOUCH_START,(function(){d.playSound("UI_click"),c().emit(m.Go_GameHome)}),this)},s.add_FSM_state=function(){this.cFSM.add_new_state(v.st_init,"st_init",this.st_init_into,this.st_init_update,this),this.cFSM.add_new_state(v.st_tutorial,"st_tutorial",this.st_tutorial_into,this.st_tutorial_update,this),this.cFSM.add_new_state(v.st_into_animation,"st_into_animation",this.st_into_animation_into,this.st_into_animation_update,this),this.cFSM.add_new_state(v.st_nextMission,"st_nextMission",this.st_nextMission_into,this.st_nextMission_update,this),this.cFSM.add_new_state(v.st_play_input,"st_play_input",this.st_play_input_into,this.st_play_input_update,this),this.cFSM.add_new_state(v.st_show_result,"st_show_result",this.st_show_result_into,this.st_show_result_update,this),this.cFSM.add_new_state(v.st_show_mission_win,"st_show_mission_win",this.st_show_mission_win_into,this.st_show_mission_win_update,this),this.cFSM.add_new_state(v.st_show_mission_err,"st_show_mission_err",this.st_show_mission_err_into,this.st_show_mission_err_update,this),this.cFSM.add_new_state(v.st_timeup_animation,"st_timeup_animation",this.st_timeup_animation_into,this.st_timeup_animation_update,this),this.cFSM.add_new_state(v.st_show_score,"st_show_score",this.st_show_score_into,this.st_show_score_update,this),this.cFSM.add_new_state(v.st_end,"st_end",this.st_end_into,this.st_end_update,this)},s.gameA_event_SquareTouch=function(t,s){if(this.cFSM.get_now_state().state==v.st_play_input||this.cFSM.get_now_state().state==v.st_show_result)for(var i=0;i<this.cSquares.length;i++)if(this.cSquares[i].node_square==t){for(var e=this.cSquares[i].PosX,n=this.cSquares[i].SquareNumber,a=0,o=0;o<this.answer_no_X[e].length;o++)this.answer_no_X[e][o]==n&&a++;for(var r=0,_=0;_<this.cSquares.length;_++)this.cSquares[_].PosX==e&&this.cSquares[_].SquareNumber==n&&r++;r<=a?(this.cSquares[i].show_error(),this.cFSM.set_Next_state(v.st_show_mission_err)):(this.cSquares[i].breakIn(),this.cFSM.get_now_state().state==v.st_play_input&&this.cFSM.set_Next_state(v.st_show_result));break}},s.st_init_into=function(){this.cSquareline.hide_line(),this.cFSM.set_Next_state(v.st_tutorial),i("Canvas/square/clone").removeAllChildren(),this.cSquares=[],this.mission=0,this.right_mission=0,this.error_mission=0,this.ComboCount=0,this.last_is_right=!1,this.node_score_panle.active=!1,this.node_TimesUp.active=!1,this.node_StartTime.active=!1,this.arrQuestionNumber=[],this.blPlay10TimesSound=!1},s.st_init_update=function(){},s.st_tutorial_into=function(){i("Canvas/tutorial").active=!0;var t=i("Canvas/tutorial/btn_start"),s=i("Canvas/tutorial/btn_next_page");t.once(e.EventType.TOUCH_START,(function(){this.cFSM.set_Next_state(v.st_into_animation),i("Canvas/tutorial").active=!1,this.node_StartTime.getComponent(p).switchShow(!0),d.playSound("countdown01")}),this),t.active=!0,s.active=!0,s.off(e.EventType.TOUCH_START),s.on(e.EventType.TOUCH_START,(function(){for(var t=0,s=0;s<this.strTutorialPath.length;s++)if(1==i(this.strTutorialPath[s]).active){t=s;break}++t>=this.strTutorialPath.length&&(t=0),n("page = "+t);for(var e=0;e<this.strTutorialPath.length;e++)i(this.strTutorialPath[e]).active=!1,e==t&&(i(this.strTutorialPath[e]).active=!0)}),this);for(var a=0;a<this.strTutorialPath.length;a++)i(this.strTutorialPath[a]).active=!1;i(this.strTutorialPath[0]).active=!0},s.st_tutorial_update=function(){},s.st_into_animation_into=function(){d.stopMusic()},s.st_into_animation_update=function(){this.node_StartTime.getComponent(p).blTimesUP&&(this.node_StartTime.active=!1,this.cFSM.set_Next_state(v.st_nextMission),this.play_last_time=1e3*this.md.Time,d.playMusic("bgm02"))},s.st_nextMission_into=function(){if(i("Canvas/square/clone").removeAllChildren(),this.cSquares=[],this.cSquareline.hide_line(),this.mission++,0==this.arrQuestionNumber.length){for(var t=0;t<this.md.QuestionCounts;t++)this.arrQuestionNumber.push(t+1);for(var s=0;s<this.md.QuestionCounts;s++){var e=Math.floor(Math.random()*this.arrQuestionNumber.length),a=Math.floor(Math.random()*this.arrQuestionNumber.length);if(e!=a){var o=this.arrQuestionNumber[e];this.arrQuestionNumber[e]=this.arrQuestionNumber[a],this.arrQuestionNumber[a]=o}}}var r=this.arrQuestionNumber.pop(),_=this.md.QuestionSet["Question_"+r];n("mission : "+r);var h=[0,0,0,0,0,0,0,0,0];this.answer_no_X=[],this.answer_no_X.push([]),this.answer_no_X.push([]),this.answer_no_X.push([]);for(var u=0;u<3;u++){var l=_.Answer.Row1[u];if(l>0){var c=this.cSquareData.getMapData(l,u,0);this.cSquareData.squareData_add(h,c),this.answer_no_X[u].push(l)}}for(var m=0;m<3;m++){var d=_.Answer.Row2[m];if(d>0){var p=this.cSquareData.getMapData(d,m,1);this.cSquareData.squareData_add(h,p),this.answer_no_X[m].push(d)}}for(var S=0;S<3;S++){var f=_.Answer.Row3[S];if(f>0){var g=this.cSquareData.getMapData(f,S,2);this.cSquareData.squareData_add(h,g),this.answer_no_X[S].push(f)}}this.cSquareline.show_line(h),this.answerMapData=h;for(var q=0;q<3;q++){var C=_.Content.Row3[q];if(C>0){var M=new w;M.init(C,this.cSquareData.unitSet),M.move(q,2),this.cSquares.push(M)}}for(var b=0;b<3;b++){var T=_.Content.Row2[b];if(T>0){var y=new w;y.init(T,this.cSquareData.unitSet),y.move(b,1),this.cSquares.push(y)}}for(var D=0;D<3;D++){var P=_.Content.Row1[D];if(P>0){var x=new w;x.init(P,this.cSquareData.unitSet),x.move(D,0),this.cSquares.push(x)}}for(var N=0;N<this.cSquares.length;N++)this.cSquares[N].setAllSquare(this.cSquares);this.cFSM.set_Next_state(v.st_play_input)},s.st_nextMission_update=function(){},s.st_play_input_into=function(){},s.st_play_input_update=function(){},s.st_show_result_into=function(){},s.st_show_result_update=function(){for(var t=!1,s=!1,i=0;i<this.cSquares.length;i++)1==this.cSquares[i].blBreakIn&&(t=!0),1==this.cSquares[i].blMoveDown&&(s=!0),this.cSquares[i].update();if(0==t&&0==s){for(var e=0;e<this.cSquares.length;e++)this.cSquares[e].moveDown()&&(s=!0);if(0==s){for(var n=[0,0,0,0,0,0,0,0,0],a=0;a<this.cSquares.length;a++){var o=this.cSquares[a];this.cSquareData.squareData_add(n,this.cSquareData.getMapData(o.SquareNumber,o.PosX,o.PosY))}this.cSquareData.check_equal(n,this.answerMapData)?this.cFSM.set_Next_state(v.st_show_mission_win):this.cFSM.set_Next_state(v.st_play_input)}}},s.st_show_mission_win_into=function(){for(var t=0;t<this.cSquares.length;t++)this.cSquares[t].show_win();this.cFSM.get_now_state().wait_time=500,this.right_mission++,d.playSound("answer02"),this.last_is_right&&this.ComboCount++,this.last_is_right=!0},s.st_show_mission_win_update=function(){this.cFSM.set_Next_state(v.st_nextMission)},s.st_show_mission_err_into=function(){this.error_mission++,d.playSound("answer01"),this.cFSM.get_now_state().wait_time=500,this.last_is_right=!1},s.st_show_mission_err_update=function(){this.cFSM.set_Next_state(v.st_nextMission)},s.st_timeup_animation_into=function(){this.node_TimesUp.getComponent(p).switchShow(!0),d.stopMusic()},s.st_timeup_animation_update=function(){this.node_TimesUp.getComponent(p).blTimesUP&&this.cFSM.set_Next_state(v.st_show_score)},s.st_show_score_into=function(){this.mission=this.right_mission+this.error_mission,l().setWin(this.mission,this.right_mission,this.ComboCount),this.node_score_panle.active=!0,this.node_TimesUp.active=!1,this.node_score_panle.getChildByName("again").once(e.EventType.TOUCH_START,(function(){d.playSound("UI_click"),this.cFSM.set_Next_state(v.st_init)}),this),this.node_score_panle.getChildByName("exit").once(e.EventType.TOUCH_START,(function(){d.playSound("UI_click"),this.cFSM.set_Next_state(v.st_end)}),this),this.node_score_panle.getChildByName("right_num").getComponent(a).string=this.right_mission.toString(),this.node_score_panle.getChildByName("err_num").getComponent(a).string=this.error_mission.toString(),this.node_score_panle.getChildByName("rate").getComponent(a).string=Math.floor(100*this.right_mission/this.mission).toString()+"%",this.node_score_panle.getChildByName("time_num").getComponent(a).string=l().time_num.toString()+"s",this.node_score_panle.getChildByPath("score/right_score").getComponent(o).string="<b><color=#7a4706>"+l().play_score.toString()+"</color></b>",this.node_score_panle.getChildByPath("score/combo_score").getComponent(o).string="<b><color=#7a4706>"+l().comble_score.toString()+"</color></b>",this.node_score_panle.getChildByPath("score/total_score").getComponent(o).string="<b><color=#7a4706>"+l().play_totle_score.toString()+"</color></b>";var t=l().myRankData[l().select_Game-1].score;this.node_score_panle.getChildByPath("score/total_score-001").getComponent(o).string="<b><color=f8e0b3>"+t.toString()+"</color></b>";for(var s=["txt_objext/title/成績結算_小標_打破障礙","txt_objext/title/成績結算_小標_點擊加法","txt_objext/title/成績結算_小標_安全路徑","","txt_objext/title/成績結算_小標_切換顏色"],i=0;i<5;i++)3!=i&&(i==l().select_Game-1?this.node_score_panle.getChildByPath(s[i]).active=!0:this.node_score_panle.getChildByPath(s[i]).active=!1);d.playSound("result01")},s.st_show_score_update=function(){var t=Math.floor(this.cFSM.get_now_state().elapsed_time/33);if(t<=25){var s=this.right_mission/this.mission*(t/25);s=Math.round(100*s)/100*-1,i("Canvas/score_panle/成績結算_藍圈").getComponent(r).fillRange=s}},s.st_end_into=function(){c().emit(m.Go_GameHome)},s.st_end_update=function(){},s.update=function(){var t=Date.now()-this.last_timestamp;if(!(t<33)&&(this.last_timestamp=Date.now(),this.cFSM.update(),this.cFSM.get_now_state().state==v.st_play_input)){l().getIsInTestMode()&&(t=0),this.play_last_time=this.play_last_time-t,this.play_last_time<0&&(this.play_last_time=0);var s=Math.floor(this.play_last_time/1e3),e=Math.floor(this.play_last_time%1e3/10);i("Canvas/game_text_node/time/TimeText_sec").getComponent(o).string="<color=#ffffff>"+s.toString().padStart(2,"0")+":</color>",i("Canvas/game_text_node/time/TimeText_msec").getComponent(o).string="<color=#ffffff>"+e.toString().padStart(2,"0")+"</color>",this.play_last_time<=0&&this.cFSM.set_Next_state(v.st_timeup_animation),0==this.blPlay10TimesSound&&this.play_last_time<=3e3&&(this.blPlay10TimesSound=!0,d.playSound("countdown01"))}},t}(),q=null;s._RF.pop()}}}));

System.register("chunks:///_virtual/Proc_B_scene.ts",["cc","./Common.ts","./AudioManager.ts","./gtool_start_time.ts","./gameB_MathButton.ts"],(function(t){"use strict";var s,i,e,n,o,_,a,h,r,u,c,m,l,p;return{setters:[function(t){s=t.cclegacy,i=t.find,e=t.Node,n=t.log,o=t.RichText,_=t.Label,a=t.Sprite},function(t){h=t.CFSM,r=t.getST,u=t.common_getEventTarget,c=t.EventEnum_Scene},function(t){m=t.AudioManager},function(t){l=t.gtool_start_time},function(t){p=t.gameB_MathButton}],execute:function(){var d;t("getProc_B_scene",(function(){null===w&&(w=new g,console.log("new Proc_B_scene"));return w})),s._RF.push({},"acb68aPMJJPTbgE1H8B22N0","Proc_B_scene",void 0),function(t){t[t.st_none=100]="st_none",t[t.st_init=101]="st_init",t[t.st_tutorial=102]="st_tutorial",t[t.st_into_animation=103]="st_into_animation",t[t.st_nextMission=104]="st_nextMission",t[t.st_play_input=105]="st_play_input",t[t.st_show_result=106]="st_show_result",t[t.st_show_mission_win=107]="st_show_mission_win",t[t.st_show_mission_err=108]="st_show_mission_err",t[t.st_show_score=109]="st_show_score",t[t.st_timeup_animation=110]="st_timeup_animation",t[t.st_end=111]="st_end"}(d||(d={}));var g=function(){function t(){this.last_timestamp=0,this.cFSM=new h,this.md=null,this.mission=0,this.right_mission=0,this.error_mission=0,this.ComboCount=0,this.last_is_right=!1,this.play_last_time=0,this.node_StartTime=null,this.node_TimesUp=null,this.node_score_panle=null,this.question_num=[],this.questionSet_num=[],this.questionSet_rate=[],this.Questions_node=[],this.now_answer=0,this.strTutorialPath=["Canvas/tutorial/遊戲說明_01","Canvas/tutorial/遊戲說明_02","Canvas/tutorial/遊戲說明_03"],this.blPlay10TimesSound=!1}var s=t.prototype;return s.init=function(){this.cFSM=new h,this.add_FSM_state(),this.cFSM.set_Next_state(d.st_init),this.last_timestamp=Date.now(),this.md=r().get_mission_data(),this.mission=0,this.right_mission=0,this.ComboCount=0,this.last_is_right=!1,u().on(c.GameB_event_MathButton,this.gameB_event_MathButton,this),i("Canvas/返回").once(e.EventType.TOUCH_START,(function(){m.playSound("UI_click"),u().emit(c.Go_GameHome)}),this),i("Canvas/tutorial").active=!1,this.node_StartTime=i("Canvas/start"),this.node_StartTime.active=!1,this.node_TimesUp=i("Canvas/timesup"),this.node_TimesUp.active=!1,this.node_score_panle=i("Canvas/score_panle"),this.node_score_panle.active=!1,this.Questions_node=[],this.Questions_node.push(i("Canvas/Questions/Questions_001")),this.Questions_node.push(i("Canvas/Questions/Questions_002")),this.Questions_node.push(i("Canvas/Questions/Questions_003"));for(var t=0,s=0;s<this.md.QuestionSet.QuestionType.length;s++)this.questionSet_num.push(this.md.QuestionSet.QuestionType[s]),t+=this.md.QuestionSet.QuestionProbability[s],this.questionSet_rate.push(t)},s.add_FSM_state=function(){this.cFSM.add_new_state(d.st_init,"st_init",this.st_init_into,this.st_init_update,this),this.cFSM.add_new_state(d.st_tutorial,"st_tutorial",this.st_tutorial_into,this.st_tutorial_update,this),this.cFSM.add_new_state(d.st_into_animation,"st_into_animation",this.st_into_animation_into,this.st_into_animation_update,this),this.cFSM.add_new_state(d.st_nextMission,"st_nextMission",this.st_nextMission_into,this.st_nextMission_update,this),this.cFSM.add_new_state(d.st_play_input,"st_play_input",this.st_play_input_into,this.st_play_input_update,this),this.cFSM.add_new_state(d.st_show_result,"st_show_result",this.st_show_result_into,this.st_show_result_update,this),this.cFSM.add_new_state(d.st_show_mission_win,"st_show_mission_win",this.st_show_mission_win_into,this.st_show_mission_win_update,this),this.cFSM.add_new_state(d.st_show_mission_err,"st_show_mission_err",this.st_show_mission_err_into,this.st_show_mission_err_update,this),this.cFSM.add_new_state(d.st_show_score,"st_show_score",this.st_show_score_into,this.st_show_score_update,this),this.cFSM.add_new_state(d.st_timeup_animation,"st_timeup_animation",this.st_timeup_animation_into,this.st_timeup_animation_update,this),this.cFSM.add_new_state(d.st_end,"st_end",this.st_end_into,this.st_end_update,this)},s.gameB_event_MathButton=function(t){n("gameB_event_MathButton:"+t),this.now_answer+=t,this.now_answer==this.question_num[0]?this.cFSM.set_Next_state(d.st_show_mission_win):this.now_answer>this.question_num[0]&&this.cFSM.set_Next_state(d.st_show_mission_err)},s.get_next_question=function(){0==this.question_num.length&&this.create_10_question();var t=this.question_num.shift();return this.create_10_question(),t},s.create_10_question=function(){for(var t=10-this.question_num.length,s=0;s<t;s++)for(;;){for(var i=Math.random()*this.questionSet_rate.at(-1),e=0,n=0;s<this.questionSet_rate.length;n++)if(i<=this.questionSet_rate[n]){e=n;break}for(var o=this.questionSet_num[e],_=!1,a=0;a<this.question_num.length;a++)if(this.question_num[a]==o){_=!0;break}if(0==_){this.question_num.push(o);break}}},s.st_init_into=function(){this.question_num=[],this.mission=0,this.right_mission=0,this.error_mission=0,this.ComboCount=0,this.last_is_right=!1,this.node_score_panle.active=!1,this.node_TimesUp.active=!1,this.node_StartTime.active=!1;for(var t=0;t<this.Questions_node.length;t++)this.Questions_node[t].getChildByName("MathText").getComponent(o).string="<color=#000000>--</color>";this.cFSM.set_Next_state(d.st_tutorial),this.blPlay10TimesSound=!1},s.st_init_update=function(){},s.st_tutorial_into=function(){i("Canvas/tutorial").active=!0;var t=i("Canvas/tutorial/btn_start"),s=i("Canvas/tutorial/btn_next_page");t.once(e.EventType.TOUCH_START,(function(){this.cFSM.set_Next_state(d.st_into_animation),i("Canvas/tutorial").active=!1,this.node_StartTime.getComponent(l).switchShow(!0),m.playSound("countdown01")}),this),t.active=!0,s.active=!0,s.off(e.EventType.TOUCH_START),s.on(e.EventType.TOUCH_START,(function(){for(var t=0,s=0;s<this.strTutorialPath.length;s++)if(1==i(this.strTutorialPath[s]).active){t=s;break}++t>=this.strTutorialPath.length&&(t=0),n("page = "+t);for(var e=0;e<this.strTutorialPath.length;e++)i(this.strTutorialPath[e]).active=!1,e==t&&(i(this.strTutorialPath[e]).active=!0)}),this);for(var o=0;o<this.strTutorialPath.length;o++)i(this.strTutorialPath[o]).active=!1;i(this.strTutorialPath[0]).active=!0},s.st_tutorial_update=function(){},s.st_into_animation_into=function(){m.stopMusic()},s.st_into_animation_update=function(){this.node_StartTime.getComponent(l).blTimesUP&&(this.node_StartTime.active=!1,this.cFSM.set_Next_state(d.st_nextMission),this.play_last_time=1e3*this.md.Time,m.playMusic("bgm02"))},s.st_nextMission_into=function(){this.mission++,this.now_answer=0,this.get_next_question();for(var t=0;t<this.Questions_node.length;t++){this.Questions_node[t].getChildByName("MathText").getComponent(o).string="<color=#000000>"+this.question_num[t]+"</color>"}this.cFSM.set_Next_state(d.st_play_input)},s.st_nextMission_update=function(){},s.st_play_input_into=function(){i("Canvas/mathButton").getComponent(p).touchSwitch(!0)},s.st_play_input_update=function(){},s.st_show_result_into=function(){},s.st_show_result_update=function(){},s.st_show_mission_win_into=function(){i("Canvas/mathButton").getComponent(p).touchSwitch(!1),i("Canvas/Answer/ok").active=!0,this.right_mission++,m.playSound("answer02"),this.cFSM.get_now_state().wait_time=500,this.last_is_right&&this.ComboCount++,this.last_is_right=!0},s.st_show_mission_win_update=function(){i("Canvas/Answer/ok").active=!1,this.cFSM.set_Next_state(d.st_nextMission)},s.st_show_mission_err_into=function(){i("Canvas/mathButton").getComponent(p).touchSwitch(!1),this.error_mission++,m.playSound("answer01"),i("Canvas/Answer/err").active=!0,this.cFSM.get_now_state().wait_time=500,this.last_is_right=!1},s.st_show_mission_err_update=function(){i("Canvas/Answer/err").active=!1,this.cFSM.set_Next_state(d.st_nextMission)},s.st_show_score_into=function(){this.mission=this.right_mission+this.error_mission,r().setWin(this.mission,this.right_mission,this.ComboCount),this.node_score_panle.active=!0,this.node_TimesUp.active=!1,this.node_score_panle.getChildByName("again").once(e.EventType.TOUCH_START,(function(){m.playSound("UI_click"),this.cFSM.set_Next_state(d.st_init)}),this),this.node_score_panle.getChildByName("exit").once(e.EventType.TOUCH_START,(function(){m.playSound("UI_click"),this.cFSM.set_Next_state(d.st_end)}),this),this.node_score_panle.getChildByName("right_num").getComponent(_).string=this.right_mission.toString(),this.node_score_panle.getChildByName("err_num").getComponent(_).string=this.error_mission.toString(),this.node_score_panle.getChildByName("rate").getComponent(_).string=Math.floor(100*this.right_mission/this.mission).toString()+"%",this.node_score_panle.getChildByName("time_num").getComponent(_).string=r().time_num.toString()+"s",this.node_score_panle.getChildByPath("score/right_score").getComponent(o).string="<b><color=#7a4706>"+r().play_score.toString()+"</color></b>",this.node_score_panle.getChildByPath("score/combo_score").getComponent(o).string="<b><color=#7a4706>"+r().comble_score.toString()+"</color></b>",this.node_score_panle.getChildByPath("score/total_score").getComponent(o).string="<b><color=#7a4706>"+r().play_totle_score.toString()+"</color></b>";var t=r().myRankData[r().select_Game-1].score;this.node_score_panle.getChildByPath("score/total_score-001").getComponent(o).string="<b><color=f8e0b3>"+t.toString()+"</color></b>";for(var s=["txt_objext/title/成績結算_小標_打破障礙","txt_objext/title/成績結算_小標_點擊加法","txt_objext/title/成績結算_小標_安全路徑","","txt_objext/title/成績結算_小標_切換顏色"],i=0;i<5;i++)3!=i&&(i==r().select_Game-1?this.node_score_panle.getChildByPath(s[i]).active=!0:this.node_score_panle.getChildByPath(s[i]).active=!1);m.playSound("result01")},s.st_show_score_update=function(){var t=Math.floor(this.cFSM.get_now_state().elapsed_time/33);if(t<=25){var s=this.right_mission/this.mission*(t/25);s=Math.round(100*s)/100*-1,i("Canvas/score_panle/成績結算_藍圈").getComponent(a).fillRange=s}},s.st_timeup_animation_into=function(){i("Canvas/mathButton").getComponent(p).touchSwitch(!1),this.node_TimesUp.getComponent(l).switchShow(!0),m.stopMusic()},s.st_timeup_animation_update=function(){this.node_TimesUp.getComponent(l).blTimesUP&&this.cFSM.set_Next_state(d.st_show_score)},s.st_end_into=function(){u().emit(c.Go_GameHome)},s.st_end_update=function(){},s.update=function(){var t=Date.now()-this.last_timestamp;if(!(t<33)&&(this.last_timestamp=Date.now(),this.cFSM.update(),this.cFSM.get_now_state().state==d.st_play_input)){r().getIsInTestMode()&&(t=0),this.play_last_time=this.play_last_time-t,this.play_last_time<0&&(this.play_last_time=0);var s=Math.floor(this.play_last_time/1e3).toString().padStart(2,"0"),e=Math.floor(this.play_last_time%1e3/10).toString().padStart(2,"0");i("Canvas/time/TimeText_sec").getComponent(o).string="<color=#ffffff>"+s+":</color>",i("Canvas/time/TimeText_msec").getComponent(o).string="<color=#ffffff>"+e+"</color>",this.play_last_time<=0&&this.cFSM.set_Next_state(d.st_timeup_animation),0==this.blPlay10TimesSound&&this.play_last_time<=3e3&&(this.blPlay10TimesSound=!0,m.playSound("countdown01"))}},t}(),w=null;s._RF.pop()}}}));

System.register("chunks:///_virtual/Proc_C_scene.ts",["cc","./Common.ts","./AudioManager.ts","./gtool_start_time.ts","./gameC_MapButton.ts"],(function(t){"use strict";var s,i,a,e,_,o,n,h,r,m,l,u,c,p,d,g,v;return{setters:[function(t){s=t.cclegacy,i=t.Vec2,a=t.find,e=t.Node,_=t.log,o=t.instantiate,n=t.Sprite,h=t.Color,r=t.Label,m=t.RichText},function(t){l=t.CFSM,u=t.getST,c=t.common_getEventTarget,p=t.EventEnum_Scene},function(t){d=t.AudioManager},function(t){g=t.gtool_start_time},function(t){v=t.gameC_MapButton}],execute:function(){var f;t("getProc_C_scene",(function(){null===S&&(S=new b,console.log("new Proc_C_scene"));return S})),s._RF.push({},"e24369rMipOPY+5GTZZtw26","Proc_C_scene",void 0),function(t){t[t.st_none=100]="st_none",t[t.st_init=101]="st_init",t[t.st_tutorial=102]="st_tutorial",t[t.st_into_animation=103]="st_into_animation",t[t.st_nextMission=104]="st_nextMission",t[t.st_waitRealStart=105]="st_waitRealStart",t[t.st_realStart=106]="st_realStart",t[t.st_play_input=107]="st_play_input",t[t.st_show_getStar=108]="st_show_getStar",t[t.st_show_result=109]="st_show_result",t[t.st_show_mission_win=110]="st_show_mission_win",t[t.st_show_mission_err=111]="st_show_mission_err",t[t.st_show_score=112]="st_show_score",t[t.st_timeup_animation=113]="st_timeup_animation",t[t.st_end=114]="st_end"}(f||(f={}));var b=function(){function t(){this.last_timestamp=0,this.cFSM=new l,this.md=null,this.mission=0,this.right_mission=0,this.error_mission=0,this.ComboCount=0,this.last_is_right=!1,this.play_last_time=0,this.node_StartTime=null,this.node_TimesUp=null,this.node_score_panle=null,this.map_node=null,this.touch_flag=!1,this.star_flag=!1,this.star_pos=0,this.end_pos=0,this.start_pos=0,this.question_num=[],this.question_mapData=[],this.answer_mapData=[],this.MapButton_0=null,this.game_base_obj=[],this.game_obj_clone=null,this.game_base_obj_v2=new i(-187.5,190),this.game_base_obj_add_x=125,this.game_base_obj_add_y=127,this.game_objinMap=[],this.real_start_btn=null,this.strTutorialPath=["Canvas/tutorial/遊戲說明_01","Canvas/tutorial/遊戲說明_02","Canvas/tutorial/遊戲說明_03"],this.blPlay10TimesSound=!1}var s=t.prototype;return s.init=function(){this.cFSM=new l,this.add_FSM_state(),this.cFSM.set_Next_state(f.st_init),this.last_timestamp=Date.now(),this.md=u().get_mission_data(),this.mission=0,this.right_mission=0,this.ComboCount=0,this.last_is_right=!1,a("Canvas/返回").once(e.EventType.TOUCH_START,(function(){d.playSound("UI_click"),c().emit(p.Go_GameHome)}),this),a("Canvas/tutorial").active=!1,this.node_StartTime=a("Canvas/start"),this.node_StartTime.active=!1,this.node_TimesUp=a("Canvas/timesup"),this.node_TimesUp.active=!1,this.node_score_panle=a("Canvas/score_panle"),this.node_score_panle.active=!1,this.init_map_node();for(var t=0;t<4;t++)for(var s=0;s<16;s++)this.map_node[t][s].active=0==t;this.MapButton_0=a("Canvas/格子/一般格子").getComponent(v),c().on(p.GameC_event_MapButton,this.gameC_event_MapButton,this),this.game_base_obj=[],this.game_base_obj.push(a("Canvas/出題物件/炸彈爆炸")),this.game_base_obj.push(a("Canvas/出題物件/星星")),this.game_base_obj.push(a("Canvas/出題物件/旗子")),this.game_base_obj.push(a("Canvas/出題物件/炸彈")),this.game_obj_clone=a("Canvas/clone"),this.real_start_btn=a("Canvas/background/real_start"),this.real_start_btn.active=!1,this.real_start_btn.getChildByPath("real_start_btn").on(e.EventType.TOUCH_START,(function(){this.cFSM.set_Next_state(f.st_realStart),this.real_start_btn.active=!1,a("Canvas/background/提示/提示文字1").active=!1}),this)},s.add_FSM_state=function(){this.cFSM.add_new_state(f.st_init,"st_init",this.st_init_into,this.st_init_update,this),this.cFSM.add_new_state(f.st_tutorial,"st_tutorial",this.st_tutorial_into,this.st_tutorial_update,this),this.cFSM.add_new_state(f.st_into_animation,"st_into_animation",this.st_into_animation_into,this.st_into_animation_update,this),this.cFSM.add_new_state(f.st_nextMission,"st_nextMission",this.st_nextMission_into,this.st_nextMission_update,this),this.cFSM.add_new_state(f.st_waitRealStart,"st_waitRealStart",this.st_waitRealStart_into,this.st_waitRealStart_update,this),this.cFSM.add_new_state(f.st_realStart,"st_play_input",this.st_realStart_into,this.st_realStart_update,this),this.cFSM.add_new_state(f.st_play_input,"st_play_input",this.st_play_input_into,this.st_play_input_update,this),this.cFSM.add_new_state(f.st_show_getStar,"st_show_getStar",this.st_show_getStar_into,this.st_show_getStar_update,this),this.cFSM.add_new_state(f.st_show_result,"st_show_result",this.st_show_result_into,this.st_show_result_update,this),this.cFSM.add_new_state(f.st_show_mission_win,"st_show_mission_win",this.st_show_mission_win_into,this.st_show_mission_win_update,this),this.cFSM.add_new_state(f.st_show_mission_err,"st_show_mission_err",this.st_show_mission_err_into,this.st_show_mission_err_update,this),this.cFSM.add_new_state(f.st_show_score,"st_show_score",this.st_show_score_into,this.st_show_score_update,this),this.cFSM.add_new_state(f.st_timeup_animation,"st_timeup_animation",this.st_timeup_animation_into,this.st_timeup_animation_update,this),this.cFSM.add_new_state(f.st_end,"st_end",this.st_end_into,this.st_end_update,this)},s.gameC_event_MapButton=function(t){if(_("gameC_event_MapButton index:"+t),this.cFSM.get_now_state().state==f.st_play_input){if(255==t){for(var s=0;s<4;s++)for(var i=0;i<16;i++)this.map_node[s][i].active=0==s;for(var a=0;a<16;a++)this.answer_mapData[a]=0;return this.touch_flag=!1,this.start_pos=-1,void this.MapButton_0.resetTouch()}1!=this.answer_mapData[t]&&(0!=this.touch_flag?(this.map_node[3][t].active=!0,this.answer_mapData[t]=1,1==this.question_mapData[t]?(this.MapButton_0.touchSwitch(!1),this.star_flag=!0,this.cFSM.set_Next_state(f.st_show_getStar)):2==this.question_mapData[t]&&(this.MapButton_0.touchSwitch(!1),this.cFSM.set_Next_state(f.st_show_result),this.end_pos=t)):2==this.question_mapData[t]?(this.touch_flag=!0,this.map_node[3][t].active=!0,this.answer_mapData[t]=1,this.start_pos=t):this.MapButton_0.resetTouch())}},s.init_map_node=function(){this.map_node=[];for(var t=["Canvas/格子/一般格子/方塊_一般","Canvas/格子/碰到星或旗子_格子/方塊_一般","Canvas/格子/碰到炸彈_格子/方塊_一般","Canvas/格子/行進中_格子/方塊_一般"],s=0;s<4;s++){for(var i=[],e=0;e<16;e++){var _=t[s];e>0&&(_=_+"-"+e.toString().padStart(3,"0"));var o=a(_);o.active=!1,i.push(o)}this.map_node.push(i)}},s.get_next_question=function(){0==this.question_num.length&&this.create_10_question();var t=this.question_num.shift();this.create_10_question();var s=[];this.answer_mapData=[];for(var i=0;i<16;i++)s.push(0),this.answer_mapData.push(0);this.MapButton_0.resetTouch();var a=this.md.QuestionSet["Question_"+(t+1)];_(a);for(var e=0;e<a.TargetPoint.length;e++){s[a.TargetPoint[e]-1]=2}for(var o=0;o<a.PlusPoint.length;o++){s[a.PlusPoint[o]-1]=1}for(var n=a.BombCounts[Math.floor(Math.random()*a.BombCounts.length)],h=[],r=0;r<16;r++)0==s[r]&&-1==a.SafePoint.indexOf(r+1)&&h.push(r);for(var m=0;m<n;m++){var l=Math.floor(Math.random()*h.length),u=h[l];h.splice(l,1),s[u]=3}return s},s.create_10_question=function(){for(var t=10-this.question_num.length,s=0;s<t;s++)for(;;){var i=20*Math.random();i>=20&&(i=19);for(var a=Math.floor(i),e=!1,_=0;_<this.question_num.length;_++)if(this.question_num[_]==a){e=!0;break}if(0==e){this.question_num.push(a);break}}},s.st_init_into=function(){this.touch_flag=!1,this.mission=0,this.right_mission=0,this.error_mission=0,this.ComboCount=0,this.last_is_right=!1,this.node_score_panle.active=!1,this.node_TimesUp.active=!1,this.node_StartTime.active=!1,this.cFSM.set_Next_state(f.st_tutorial),this.game_obj_clone.destroyAllChildren(),this.blPlay10TimesSound=!1},s.st_init_update=function(){},s.st_tutorial_into=function(){a("Canvas/tutorial").active=!0;var t=a("Canvas/tutorial/btn_start"),s=a("Canvas/tutorial/btn_next_page");t.once(e.EventType.TOUCH_START,(function(){this.cFSM.set_Next_state(f.st_into_animation),a("Canvas/tutorial").active=!1,this.node_StartTime.getComponent(g).switchShow(!0),d.playSound("countdown01")}),this),t.active=!0,s.active=!0,s.off(e.EventType.TOUCH_START),s.on(e.EventType.TOUCH_START,(function(){for(var t=0,s=0;s<this.strTutorialPath.length;s++)if(1==a(this.strTutorialPath[s]).active){t=s;break}++t>=this.strTutorialPath.length&&(t=0),_("page = "+t);for(var i=0;i<this.strTutorialPath.length;i++)a(this.strTutorialPath[i]).active=!1,i==t&&(a(this.strTutorialPath[i]).active=!0)}),this);for(var i=0;i<this.strTutorialPath.length;i++)a(this.strTutorialPath[i]).active=!1;a(this.strTutorialPath[0]).active=!0},s.st_tutorial_update=function(){},s.st_into_animation_into=function(){d.stopMusic()},s.st_into_animation_update=function(){this.node_StartTime.getComponent(g).blTimesUP&&(this.node_StartTime.active=!1,this.cFSM.set_Next_state(f.st_nextMission),this.play_last_time=1e3*this.md.Time,d.playMusic("bgm02"))},s.st_nextMission_into=function(){this.mission++,this.star_flag=!1,this.touch_flag=!1,this.game_obj_clone.destroyAllChildren(),this.game_obj_clone.removeAllChildren(),this.question_mapData=this.get_next_question();for(var t=0;t<4;t++)for(var s=0;s<16;s++)this.map_node[t][s].active=0==t;for(var i=0;i<16;i++)if(3==this.question_mapData[i]){var a=o(this.game_base_obj[3]);this.game_obj_clone.addChild(a),this.game_objinMap[i]=a;var e=this.game_base_obj_v2.x+this.game_base_obj_add_x*(i%4),_=this.game_base_obj_v2.y-this.game_base_obj_add_y*Math.floor(i/4);a.setPosition(e,_),a.active=!0}this.start_pos=-1,this.cFSM.set_Next_state(f.st_waitRealStart)},s.st_nextMission_update=function(){},s.st_waitRealStart_into=function(){this.real_start_btn.active=!0,a("Canvas/background/提示/提示文字1").active=!0},s.st_waitRealStart_update=function(){},s.st_realStart_into=function(){this.game_obj_clone.destroyAllChildren(),this.game_obj_clone.removeAllChildren(),this.game_objinMap=[];for(var t=0;t<16;t++)if(this.game_objinMap.push(null),1==this.question_mapData[t]||2==this.question_mapData[t]){var s=o(this.game_base_obj[this.question_mapData[t]]);this.game_obj_clone.addChild(s),this.game_objinMap[t]=s;var i=this.game_base_obj_v2.x+this.game_base_obj_add_x*(t%4),a=this.game_base_obj_v2.y-this.game_base_obj_add_y*Math.floor(t/4);s.setPosition(i,a),s.active=!0,1==this.question_mapData[t]&&(this.star_pos=t)}this.cFSM.set_Next_state(f.st_play_input)},s.st_realStart_update=function(){},s.st_play_input_into=function(){this.MapButton_0.touchSwitch(!0)},s.st_play_input_update=function(){},s.st_show_getStar_into=function(){for(var t=!1,s=0;s<16;s++)if(1==this.answer_mapData[s]&&3==this.question_mapData[s]){t=!0;break}t?this.cFSM.set_Next_state(f.st_show_result):(this.right_mission++,d.playSound("answer02"))},s.st_show_getStar_update=function(){var t=Math.floor(this.cFSM.get_now_state().elapsed_time/33),s=this.game_base_obj_v2.x+this.game_base_obj_add_x*(this.star_pos%4),i=this.game_base_obj_v2.y-this.game_base_obj_add_y*Math.floor(this.star_pos/4)+6*t;if(this.game_objinMap[this.star_pos].setPosition(s,i),this.game_objinMap[this.star_pos].setScale(1+.05*t,1+.05*t),this.game_objinMap[this.star_pos].getComponent(n).color=new h(255,255,255,255-7*t),t>=25){this.game_objinMap[this.star_pos].active=!1;var a=this.game_base_obj_v2.x+this.game_base_obj_add_x*(this.star_pos%4),e=this.game_base_obj_v2.y-this.game_base_obj_add_y*Math.floor(this.star_pos/4);this.game_objinMap[this.start_pos].setPosition(a,e);for(var _=0;_<4;_++)for(var o=0;o<16;o++)this.map_node[_][o].active=0==_;for(var r=0;r<16;r++)this.answer_mapData[r]=0;this.question_mapData[this.start_pos]=0,this.question_mapData[this.star_pos]=2,this.touch_flag=!1,this.start_pos=-1,this.MapButton_0.resetTouch(),this.cFSM.set_Next_state(f.st_play_input)}},s.st_show_result_into=function(){for(var t=0;t<4;t++)for(var s=0;s<16;s++)this.answer_mapData[s]>0&&1==t||0==this.answer_mapData[s]&&0==t?this.map_node[t][s].active=!0:this.map_node[t][s].active=!1;this.cFSM.get_now_state().wait_time=1e3},s.st_show_result_update=function(){for(var t=!1,s=0;s<16;s++)if(1==this.answer_mapData[s]&&3==this.question_mapData[s]){t=!0;break}t?this.cFSM.set_Next_state(f.st_show_mission_err):this.cFSM.set_Next_state(f.st_show_mission_win);for(var i=0;i<16;i++){var a=null;if(3==this.question_mapData[i]){a=1==this.answer_mapData[i]?o(this.game_base_obj[0]):o(this.game_base_obj[3]),this.game_obj_clone.addChild(a),this.game_objinMap[i]=a;var e=this.game_base_obj_v2.x+this.game_base_obj_add_x*(i%4),_=this.game_base_obj_v2.y-this.game_base_obj_add_y*Math.floor(i/4);a.setPosition(e,_),a.active=!0}}this.star_flag||(this.game_objinMap[this.star_pos].active=!1)},s.st_show_mission_win_into=function(){this.last_is_right&&this.ComboCount++,this.right_mission++,d.playSound("answer02"),this.last_is_right=!0},s.st_show_mission_win_update=function(){var t=Math.floor(this.cFSM.get_now_state().elapsed_time/100);this.game_objinMap[this.end_pos].active=t%2!=0,t>=6&&this.cFSM.set_Next_state(f.st_nextMission)},s.st_show_mission_err_into=function(){this.error_mission++,d.playSound("answer01"),this.last_is_right=!1;for(var t=0;t<4;t++)for(var s=0;s<16;s++)this.answer_mapData[s]>0&&2==t?this.map_node[t][s].active=!0:this.map_node[t][s].active=0==t;this.cFSM.get_now_state().wait_time=500},s.st_show_mission_err_update=function(){this.cFSM.set_Next_state(f.st_nextMission)},s.st_show_score_into=function(){this.mission=this.right_mission+this.error_mission,u().setWin(this.mission,this.right_mission,this.ComboCount),this.node_score_panle.active=!0,this.node_TimesUp.active=!1,this.node_score_panle.getChildByName("again").once(e.EventType.TOUCH_START,(function(){d.playSound("UI_click"),this.cFSM.set_Next_state(f.st_init)}),this),this.node_score_panle.getChildByName("exit").once(e.EventType.TOUCH_START,(function(){d.playSound("UI_click"),this.cFSM.set_Next_state(f.st_end)}),this),this.node_score_panle.getChildByName("right_num").getComponent(r).string=this.right_mission.toString(),this.node_score_panle.getChildByName("err_num").getComponent(r).string=this.error_mission.toString(),this.node_score_panle.getChildByName("rate").getComponent(r).string=Math.floor(100*this.right_mission/this.mission).toString()+"%",this.node_score_panle.getChildByName("time_num").getComponent(r).string=u().time_num.toString()+"s",this.node_score_panle.getChildByPath("score/right_score").getComponent(m).string="<b><color=#7a4706>"+u().play_score.toString()+"</color></b>",this.node_score_panle.getChildByPath("score/combo_score").getComponent(m).string="<b><color=#7a4706>"+u().comble_score.toString()+"</color></b>",this.node_score_panle.getChildByPath("score/total_score").getComponent(m).string="<b><color=#7a4706>"+u().play_totle_score.toString()+"</color></b>";var t=u().myRankData[u().select_Game-1].score;this.node_score_panle.getChildByPath("score/total_score-001").getComponent(m).string="<b><color=f8e0b3>"+t.toString()+"</color></b>";for(var s=["txt_objext/title/成績結算_小標_打破障礙","txt_objext/title/成績結算_小標_點擊加法","txt_objext/title/成績結算_小標_安全路徑","","txt_objext/title/成績結算_小標_切換顏色"],i=0;i<5;i++)3!=i&&(i==u().select_Game-1?this.node_score_panle.getChildByPath(s[i]).active=!0:this.node_score_panle.getChildByPath(s[i]).active=!1);d.playSound("result01")},s.st_show_score_update=function(){var t=Math.floor(this.cFSM.get_now_state().elapsed_time/33);if(t<=25){var s=this.right_mission/this.mission*(t/25);s=Math.round(100*s)/100*-1,a("Canvas/score_panle/成績結算_藍圈").getComponent(n).fillRange=s}},s.st_timeup_animation_into=function(){this.node_TimesUp.getComponent(g).switchShow(!0),d.stopMusic()},s.st_timeup_animation_update=function(){this.node_TimesUp.getComponent(g).blTimesUP&&this.cFSM.set_Next_state(f.st_show_score)},s.st_end_into=function(){c().emit(p.Go_GameHome)},s.st_end_update=function(){},s.update=function(){var t=Date.now()-this.last_timestamp;if(!(t<33)&&(this.last_timestamp=Date.now(),this.cFSM.update(),this.cFSM.get_now_state().state>=f.st_nextMission&&this.cFSM.get_now_state().state<=f.st_show_mission_err)){u().getIsInTestMode()&&(t=0),this.play_last_time=this.play_last_time-t,this.play_last_time<0&&(this.play_last_time=0);var s=Math.floor(this.play_last_time/1e3).toString().padStart(2,"0"),i=Math.floor(this.play_last_time%1e3/10).toString().padStart(2,"0");a("Canvas/time/TimeText_sec").getComponent(m).string="<color=#ffffff>"+s+":</color>",a("Canvas/time/TimeText_msec").getComponent(m).string="<color=#ffffff>"+i+"</color>",this.play_last_time<=0&&(this.MapButton_0.touchSwitch(!0),this.cFSM.set_Next_state(f.st_timeup_animation)),0==this.blPlay10TimesSound&&this.play_last_time<=3e3&&(this.blPlay10TimesSound=!0,d.playSound("countdown01"))}},t}(),S=null;s._RF.pop()}}}));

System.register("chunks:///_virtual/Proc_D_scene.ts",["cc","./Common.ts","./AudioManager.ts","./gameD_ColorButton.ts","./gameD_DiamondBox.ts","./gtool_start_time.ts"],(function(t){"use strict";var i,s,o,e,n,a,_,h,r,l,c,m,u,d,p,g;return{setters:[function(t){i=t.cclegacy,s=t.find,o=t.Node,e=t.log,n=t.Label,a=t.RichText,_=t.Sprite,h=t.instantiate},function(t){r=t.CFSM,l=t.getST,c=t.common_getEventTarget,m=t.EventEnum_Scene},function(t){u=t.AudioManager},function(t){d=t.gameD_ColorButton},function(t){p=t.gameD_DiamondBox},function(t){g=t.gtool_start_time}],execute:function(){t("getProc_D_scene",(function(){null===C&&(C=new B,console.log("new Proc_D_scene"));return C})),i._RF.push({},"fdad6AqtKxCQLwwSFdkYhXZ","Proc_D_scene",void 0);var x,f=function(){this.iRL=0,this.iUB=0,this.iColor=0,this.blMoveFast=!1,this.iBoxID=0,this.iBoxNode=null,this.diamondBox=null},v=function(){function t(){this.cBoxs=null,this.iBoxID_G=0,this.next_createBox_wait_time=0,this.createBox_wait_time_last=0,this.iMinTime=200,this.iMxnTime=500,this.iMinLineTime=1e3,this.last_RL_create_time=[0,0],this.iMaxFastBox=1,this.iMaxSlowBox=2,this.base_box_node=null,this.clone_parent_node=null}var i=t.prototype;return i.init=function(t,i){this.iBoxID_G=0,this.cBoxs=[],this.next_createBox_wait_time=this.getNextCreateBoxWaitTime(),this.createBox_wait_time_last=Date.now(),this.base_box_node=t,this.clone_parent_node=i},i.createNewBox=function(){var t=this.iMaxFastBox+this.iMaxSlowBox;if(this.cBoxs.length>=t)return!1;if(Date.now()-this.createBox_wait_time_last>=this.next_createBox_wait_time){var i=Math.floor(2*Math.random());if(Date.now()-this.last_RL_create_time[i]>this.iMinLineTime){this.last_RL_create_time[i]=Date.now(),this.createBox_wait_time_last=Date.now(),this.next_createBox_wait_time=this.getNextCreateBoxWaitTime();var s=new f;this.iBoxID_G++,s.iBoxID=this.iBoxID_G,s.iColor=Math.floor(2*Math.random()),s.iRL=i,s.iUB=Math.floor(2*Math.random());for(var o=[],n=0,a=0,_=0;_<this.cBoxs.length;_++)this.cBoxs[_].blMoveFast?n++:a++;n=this.iMaxFastBox-n,a=this.iMaxSlowBox-a;for(var r=0;r<n;r++)o.push(!0);for(var l=0;l<a;l++)o.push(!1);return s.blMoveFast=o[Math.floor(Math.random()*o.length)],e("blMoveFast",s.blMoveFast),s.iBoxNode=h(this.base_box_node),s.diamondBox=s.iBoxNode.getComponent(p),s.diamondBox.init(s.iBoxID,s.iColor,s.iRL,s.iUB,s.blMoveFast),this.clone_parent_node.addChild(s.iBoxNode),this.cBoxs.push(s),!0}}return!1},i.delBox=function(t){for(var i=0;i<this.cBoxs.length;i++)if(this.cBoxs[i].iBoxID==t)return this.clone_parent_node.removeChild(this.cBoxs[i].iBoxNode),this.cBoxs[i].iBoxNode.destroy(),this.cBoxs.splice(i,1),void(this.createBox_wait_time_last=Date.now())},i.deleteAll=function(){this.clone_parent_node.removeAllChildren(),this.cBoxs=[]},i.getNextCreateBoxWaitTime=function(){var t=Math.random()*(this.iMxnTime-this.iMinTime)+this.iMinTime;return Math.floor(t)},t}();!function(t){t[t.st_none=100]="st_none",t[t.st_init=101]="st_init",t[t.st_tutorial=102]="st_tutorial",t[t.st_into_animation=103]="st_into_animation",t[t.st_play_input=104]="st_play_input",t[t.st_timeup_animation=105]="st_timeup_animation",t[t.st_show_score=106]="st_show_score",t[t.st_end=107]="st_end"}(x||(x={}));var B=function(){function t(){this.last_timestamp=0,this.cFSM=new r,this.md=null,this.mission=0,this.right_mission=0,this.error_mission=0,this.ComboCount=0,this.last_is_right=!1,this.play_last_time=0,this.node_StartTime=null,this.node_TimesUp=null,this.node_score_panle=null,this.colorButton_RLs=[],this.box_base_node=null,this.clone_node=null,this.cBoxTool=null,this.strTutorialPath=["Canvas/tutorial/遊戲說明_01","Canvas/tutorial/遊戲說明_02","Canvas/tutorial/遊戲說明_03"],this.blPlay10TimesSound=!1}var i=t.prototype;return i.init=function(){this.cFSM=new r,this.add_FSM_state(),this.cFSM.set_Next_state(x.st_init),this.last_timestamp=Date.now(),this.md=l().get_mission_data(),this.mission=0,this.right_mission=0,this.ComboCount=0,this.last_is_right=!1,s("Canvas/返回").once(o.EventType.TOUCH_START,(function(){u.playSound("UI_click"),c().emit(m.Go_GameHome)}),this),s("Canvas/tutorial").active=!1,this.node_StartTime=s("Canvas/start"),this.node_StartTime.active=!1,this.node_TimesUp=s("Canvas/timesup"),this.node_TimesUp.active=!1,this.node_score_panle=s("Canvas/score_panle"),this.node_score_panle.active=!1,this.box_base_node=s("Canvas/box/base/diamond_box"),this.clone_node=s("Canvas/box/clone"),this.colorButton_RLs.push(s("Canvas/button_right").getComponent(d)),this.colorButton_RLs.push(s("Canvas/button_left").getComponent(d)),this.cBoxTool=new v,this.cBoxTool.init(this.box_base_node,this.clone_node),c().on(m.GameD_event_BoxMoveEnd,this.gameD_event_BoxMoveEnd,this)},i.add_FSM_state=function(){this.cFSM.add_new_state(x.st_init,"st_init",this.st_init_into,this.st_init_update,this),this.cFSM.add_new_state(x.st_tutorial,"st_tutorial",this.st_tutorial_into,this.st_tutorial_update,this),this.cFSM.add_new_state(x.st_into_animation,"st_into_animation",this.st_into_animation_into,this.st_into_animation_update,this),this.cFSM.add_new_state(x.st_play_input,"st_play_input",this.st_play_input_into,this.st_play_input_update,this),this.cFSM.add_new_state(x.st_timeup_animation,"st_timeup_animation",this.st_timeup_animation_into,this.st_timeup_animation_update,this),this.cFSM.add_new_state(x.st_show_score,"st_show_score",this.st_show_score_into,this.st_show_score_update,this),this.cFSM.add_new_state(x.st_end,"st_end",this.st_end_into,this.st_end_update,this)},i.gameD_event_BoxMoveEnd=function(t,i){this.cFSM.get_now_state().state==x.st_play_input&&(0==t?(this.right_mission++,u.playSound("answer02"),this.last_is_right&&this.ComboCount++,this.last_is_right=!0):1==t&&(this.error_mission++,u.playSound("answer01"),this.last_is_right=!1),this.mission++,2==t&&this.cBoxTool.delBox(i))},i.st_init_into=function(){this.mission=0,this.right_mission=0,this.error_mission=0,this.ComboCount=0,this.last_is_right=!1,this.play_last_time=0,this.node_score_panle.active=!1,this.cBoxTool.deleteAll(),this.cFSM.set_Next_state(x.st_tutorial),this.blPlay10TimesSound=!1},i.st_init_update=function(){},i.st_tutorial_into=function(){s("Canvas/tutorial").active=!0;var t=s("Canvas/tutorial/btn_start"),i=s("Canvas/tutorial/btn_next_page");t.once(o.EventType.TOUCH_START,(function(){this.cFSM.set_Next_state(x.st_into_animation),s("Canvas/tutorial").active=!1,this.node_StartTime.getComponent(g).switchShow(!0),u.playSound("countdown01")}),this),t.active=!0,i.active=!0,i.off(o.EventType.TOUCH_START),i.on(o.EventType.TOUCH_START,(function(){for(var t=0,i=0;i<this.strTutorialPath.length;i++)if(1==s(this.strTutorialPath[i]).active){t=i;break}++t>=this.strTutorialPath.length&&(t=0),e("page = "+t);for(var o=0;o<this.strTutorialPath.length;o++)s(this.strTutorialPath[o]).active=!1,o==t&&(s(this.strTutorialPath[o]).active=!0)}),this);for(var n=0;n<this.strTutorialPath.length;n++)s(this.strTutorialPath[n]).active=!1;s(this.strTutorialPath[0]).active=!0},i.st_tutorial_update=function(){},i.st_into_animation_into=function(){u.stopMusic()},i.st_into_animation_update=function(){this.node_StartTime.getComponent(g).blTimesUP&&(this.node_StartTime.active=!1,this.cFSM.set_Next_state(x.st_play_input),this.play_last_time=1e3*this.md.Time,u.playMusic("bgm02"))},i.st_play_input_into=function(){for(var t=0;t<this.colorButton_RLs.length;t++)this.colorButton_RLs[t].touchSwitch(!0)},i.st_play_input_update=function(){this.cBoxTool.createNewBox()&&this.mission++},i.st_timeup_animation_into=function(){this.node_TimesUp.getComponent(g).switchShow(!0),u.stopMusic()},i.st_timeup_animation_update=function(){this.node_TimesUp.getComponent(g).blTimesUP&&this.cFSM.set_Next_state(x.st_show_score)},i.st_show_score_into=function(){this.mission=this.right_mission+this.error_mission,l().setWin(this.mission,this.right_mission,this.ComboCount),this.node_score_panle.active=!0,this.node_TimesUp.active=!1,this.node_score_panle.getChildByName("again").once(o.EventType.TOUCH_START,(function(){u.playSound("UI_click"),this.cFSM.set_Next_state(x.st_init)}),this),this.node_score_panle.getChildByName("exit").once(o.EventType.TOUCH_START,(function(){u.playSound("UI_click"),this.cFSM.set_Next_state(x.st_end)}),this),this.node_score_panle.getChildByName("right_num").getComponent(n).string=this.right_mission.toString(),this.node_score_panle.getChildByName("err_num").getComponent(n).string=this.error_mission.toString(),this.node_score_panle.getChildByName("rate").getComponent(n).string=Math.floor(100*this.right_mission/this.mission).toString()+"%",this.node_score_panle.getChildByName("time_num").getComponent(n).string=l().time_num.toString()+"s",this.node_score_panle.getChildByPath("score/right_score").getComponent(a).string="<b><color=#7a4706>"+l().play_score.toString()+"</color></b>",this.node_score_panle.getChildByPath("score/combo_score").getComponent(a).string="<b><color=#7a4706>"+l().comble_score.toString()+"</color></b>",this.node_score_panle.getChildByPath("score/total_score").getComponent(a).string="<b><color=#7a4706>"+l().play_totle_score.toString()+"</color></b>";var t=l().myRankData[l().select_Game-1].score;this.node_score_panle.getChildByPath("score/total_score-001").getComponent(a).string="<b><color=f8e0b3>"+t.toString()+"</color></b>";for(var i=["txt_objext/title/成績結算_小標_打破障礙","txt_objext/title/成績結算_小標_點擊加法","txt_objext/title/成績結算_小標_安全路徑","","txt_objext/title/成績結算_小標_切換顏色"],s=0;s<5;s++)3!=s&&(s==l().select_Game-1?this.node_score_panle.getChildByPath(i[s]).active=!0:this.node_score_panle.getChildByPath(i[s]).active=!1);u.playSound("result01")},i.st_show_score_update=function(){var t=Math.floor(this.cFSM.get_now_state().elapsed_time/33);if(t<=25){var i=this.right_mission/this.mission*(t/25);i=Math.round(100*i)/100*-1,s("Canvas/score_panle/成績結算_藍圈").getComponent(_).fillRange=i}},i.st_end_into=function(){c().emit(m.Go_GameHome)},i.st_end_update=function(){},i.update=function(){var t=Date.now()-this.last_timestamp;if(!(t<33)&&(this.last_timestamp=Date.now(),this.cFSM.update(),this.cFSM.get_now_state().state==x.st_play_input)){l().getIsInTestMode()&&(t=0),this.play_last_time=this.play_last_time-t,this.play_last_time<0&&(this.play_last_time=0);var i=Math.floor(this.play_last_time/1e3).toString().padStart(2,"0"),o=Math.floor(this.play_last_time%1e3/10).toString().padStart(2,"0");if(s("Canvas/time/TimeText_sec").getComponent(a).string="<color=#ffffff>"+i+":</color>",s("Canvas/time/TimeText_msec").getComponent(a).string="<color=#ffffff>"+o+"</color>",this.play_last_time<=0){for(var e=0;e<this.colorButton_RLs.length;e++)this.colorButton_RLs[e].touchSwitch(!1);this.cFSM.set_Next_state(x.st_timeup_animation)}0==this.blPlay10TimesSound&&this.play_last_time<=3e3&&(this.blPlay10TimesSound=!0,u.playSound("countdown01"))}},t}(),C=null;i._RF.pop()}}}));

System.register("chunks:///_virtual/Proc_GameHome.ts",["cc","./Common.ts","./AudioManager.ts","./SpriteFrameManager.ts","./ground_t.ts"],(function(e){"use strict";var t,n,o,i,a,_,g,s,m,r,h,u;return{setters:[function(e){t=e.cclegacy,n=e.find,o=e.Sprite,i=e.Node,a=e.Label},function(e){_=e.common_getEventTarget,g=e.EventEnum_Scene,s=e.common_bind_touch_start,m=e.getST},function(e){r=e.AudioManager},function(e){h=e.SpriteFrameManager},function(e){u=e.ground_t}],execute:function(){e("getProc_GameHome",(function(){null===c&&(c=new p,console.log("new Proc_GameHome"));return c})),t._RF.push({},"482b7cRn7tLfLYMGeVCy/pn","Proc_GameHome",void 0);var p=function(){function e(){this.game_scene_name=[["CognitionScene"],["MathScene"],["MemoryScene"],["Rankings"],["AttentionScene"]],this.game_sprite_name=[["gh_mis_1_1"],["gh_mis_2_1"],["gh_mis_3_1"],["gh_mis_4_1"],["gh_mis_5_1"]],this.game_book_sprite_name=[["gh_mis_book_1"],["gh_mis_book_2"],["gh_mis_book_3"],["gh_mis_book_4"],["gh_mis_book_5"]],this.gameSprite=null,this.gameBookSprite=null,this.btn_goLogin_name=["Canvas/leave_btn"],this.btn_goInfo_name="Canvas/info/button",this.gh_group=1,this.gh_subpage=1}var t=e.prototype;return t.init=function(){_().on(g.Ground_Event_UpdateGroup,this.ground_event_UpdateGroup,this);for(var e=0;e<this.btn_goLogin_name.length;e++)s(this.btn_goLogin_name[e],this.gh_show_exit,this);if(s("Canvas/Exit_game/yes",this.goLogin_Y,this),s("Canvas/Exit_game/no",this.goLogin_N,this),n("Canvas/Exit_game").active=!1,s(this.btn_goInfo_name,this.goInfo,this),this.gameSprite=n("Canvas/level_book/gameSprite").getComponent(o),this.gameSprite.spriteFrame=h.getSpriteFrame(this.game_sprite_name[this.gh_group-1][this.gh_subpage-1]),this.gameBookSprite=n("Canvas/level_book/BG_book/gameSprite_book").getComponent(o),this.gameBookSprite.spriteFrame=h.getSpriteFrame(this.game_book_sprite_name[this.gh_group-1][this.gh_subpage-1]),s("Canvas/level_book/gameSprite/btn_event_Mask",this.goGame,this),m().get_bl_open_test_debug()){var t=n("Canvas/標題/debug_btn");t.active=!0,t.on(i.EventType.TOUCH_START,(function(){m().switchTestMode()?n("Canvas/標題/debug_btn/Label_sw").getComponent(a).string="Open":n("Canvas/標題/debug_btn/Label_sw").getComponent(a).string="Close"}),this),m().getIsInTestMode()?n("Canvas/標題/debug_btn/Label_sw").getComponent(a).string="Open":n("Canvas/標題/debug_btn/Label_sw").getComponent(a).string="Close"}n("Canvas/Rank/button").on(i.EventType.TOUCH_START,(function(){r.playSound("UI_click"),this.gh_subpage=1,this.gh_group=4,m().select_Game=4,this.goGameUnlock()}),this),r.playMusic("bgm01")},t.goInfo=function(){r.playSound("UI_click"),_().emit(g.Go_Info)},t.gh_show_exit=function(){n("Canvas/Exit_game").active=!0,n("Canvas/ground/btn_event_Mask/ground").getComponent(u).disableTouch()},t.ground_event_UpdateGroup=function(e){console.log("ground_event_GoGame:"+e),this.gh_group=e,m().select_Game=this.gh_group,this.gh_subpage=1,console.log("gh_group:"+this.gh_group),this.gameSprite.spriteFrame=h.getSpriteFrame(this.game_sprite_name[this.gh_group-1][this.gh_subpage-1]),this.gameBookSprite.spriteFrame=h.getSpriteFrame(this.game_book_sprite_name[this.gh_group-1][this.gh_subpage-1])},t.goGame=function(){r.playSound("UI_click"),4!=m().select_Game&&_().emit(g.Go_Game)},t.goGameUnlock=function(){r.playSound("UI_click"),_().emit(g.Go_Game)},t.goLogin_Y=function(){r.playSound("UI_click"),window.location.href="../index.html"},t.goLogin_N=function(){r.playSound("UI_click"),n("Canvas/Exit_game").active=!1,n("Canvas/ground/btn_event_Mask/ground").getComponent(u).enableTouch()},t.getGameSceneName=function(){return this.game_scene_name[this.gh_group-1][this.gh_subpage-1]},e}(),c=null;t._RF.pop()}}}));

System.register("chunks:///_virtual/Proc_Info.ts",["cc","./Common.ts","./AudioManager.ts"],(function(n){"use strict";var t,o,e,c,i;return{setters:[function(n){t=n.cclegacy},function(n){o=n.common_bind_touch_start,e=n.common_getEventTarget,c=n.EventEnum_Scene},function(n){i=n.AudioManager}],execute:function(){n("getProc_Info",(function(){null===u&&(u=new a,console.log("new Proc_GameHome"));return u})),t._RF.push({},"85c37WXNS5AGa7IYY9TV03k","Proc_Info",void 0);var a=function(){function n(){this.btn_goHome_name=["Canvas/返回"]}var t=n.prototype;return t.init=function(){for(var n=0;n<this.btn_goHome_name.length;n++)o(this.btn_goHome_name[n],this.goHome,this);o("Canvas/N_Button/button",(function(){window.location.href="http://axis.chanliu.org/"}),this),o("Canvas/N_Button/button-001",(function(){window.location.href="http://flames.chanliu.org/"}),this),o("Canvas/N_Button/button-002",(function(){window.location.href="http://cachecache.chanliu.org/"}),this)},t.goHome=function(){i.playSound("UI_click"),e().emit(c.Go_GameHome)},n}(),u=null;t._RF.pop()}}}));

System.register("chunks:///_virtual/Proc_Login.ts",["cc","./Common.ts","./AudioManager.ts","./SpriteFrameManager.ts"],(function(i){"use strict";var n,t,o,a,e,s,r,c;return{setters:[function(i){n=i.cclegacy,t=i.find},function(i){o=i.getST,a=i.common_bind_touch_start,e=i.common_getEventTarget,s=i.EventEnum_Scene},function(i){r=i.AudioManager},function(i){c=i.SpriteFrameManager}],execute:function(){i("getProc_Login",(function(){null===g&&(g=new u,console.log("new Proc_Login"));return g})),n._RF.push({},"8f37c94yf1ACr/HKm9D5ZeB","Proc_Login",void 0);var u=function(){function i(){this.isRunning=!1,this.isLoading=!1,this.wait_loading_time=0}var n=i.prototype;return n.init=function(){this.isLoading=!0,this.wait_loading_time=Date.now()+1e3,this.isRunning=!0,o().init(),t("Canvas/Loading").active=!0,t("Canvas/story").active=!1,a("Canvas/story/開始訓練_一般",this.go_GameHome,this),r.playMusic("bgm01")},n.go_GameHome=function(){r.playSound("UI_click"),r.playMusic("bgm01"),e().emit(s.Go_GameHome)},n.update=function(){if(this.isLoading&&Date.now()>this.wait_loading_time){if(0==o().isLoadOk)return;if(0==r.isLoadOk())return;if(0==c.isLoadOk())return;this.isLoading=!1,this.isRunning=!1,t("Canvas/Loading").active=!1,t("Canvas/story").active=!0}},i}(),g=null;n._RF.pop()}}}));

System.register("chunks:///_virtual/Proc_R_scene.ts",["cc","./Common.ts","./AudioManager.ts"],(function(n){"use strict";var e,t,a,o,i,s,_,c,r,v;return{setters:[function(n){e=n.cclegacy,t=n.find,a=n.RichText,o=n.instantiate,i=n.Label},function(n){s=n.common_bind_touch_start,_=n.getST,c=n.common_getEventTarget,r=n.EventEnum_Scene},function(n){v=n.AudioManager}],execute:function(){var l;n("getProc_R_scene",(function(){null===h&&(h=new g,console.log("new Proc_R_scene"));return h})),e._RF.push({},"970cdsx7QVOLrb5NiUNwevh","Proc_R_scene",void 0),function(n){n[n.st_none=100]="st_none",n[n.st_init=101]="st_init",n[n.st_end=102]="st_end"}(l||(l={}));var g=function(){function n(){this.state=l.st_none,this.page_name=["page_01","page_02","page_03","page_04"],this.strButtonPath=["Canvas/BG/view/跳出選單_切換顏色_一般","Canvas/BG/view/跳出選單_安全路徑_一般","Canvas/BG/view/跳出選單_點擊加法_一般","Canvas/BG/項目/總排行","Canvas/BG/view/跳出選單_打破障礙_一般"],this.strButtonName=["跳出選單_切換顏色_一般","跳出選單_安全路徑_一般","跳出選單_點擊加法_一般","總排行","跳出選單_打破障礙_一般"],this.now_page=1}var e=n.prototype;return e.init=function(){this.now_page=1,s("Canvas/BG/總排行_背景/外框/返回",this.go_GameHome,this);for(var n=0;n<this.strButtonPath.length;n++)s(this.strButtonPath[n],this.onSelectGame,this);s("Canvas/BG/view/返回",this.onCloseSelectGame,this),s("Canvas/BG/項目/下拉選單",this.onOpenSelectGame,this),this.update_page()},e.onOpenSelectGame=function(){v.playSound("UI_click"),t("Canvas/BG/view").active=!0},e.onCloseSelectGame=function(){v.playSound("UI_click"),t("Canvas/BG/view").active=!1},e.onSelectGame=function(n){t("Canvas/BG/view").active=!1,v.playSound("UI_click");var e=this.strButtonName.indexOf(n.target.name);-1!=e&&(this.now_page=e+1,this.update_page())},e.update_page=function(){var n=t("Canvas/BG/ScrollView/view/content/clone"),e=t("Canvas/BG/ScrollView/view/content/base/item");n.destroyAllChildren(),n.removeAllChildren(),t("Canvas/BG/playerinfo/playerName").getComponent(a).string="<b><color=#492c1c>"+_().myRankData[this.now_page-1].name+"</color></b>",t("Canvas/BG/playerinfo/sc01").getComponent(a).string="<b><color=#492c1c>"+_().myRankData[this.now_page-1].rank+"</color></b>",t("Canvas/BG/playerinfo/sc02").getComponent(a).string="<b><color=#492c1c>"+_().myRankData[this.now_page-1].score+"</color></b>";for(var s=_().rank_data[this.now_page-1],c=0;c<s.length;c++){var r=o(e);n.addChild(r);var v=r.getChildByName("num").getComponent(i),l=r.getChildByName("name").getComponent(i),g=r.getChildByName("score").getComponent(i);v.string=s[c].rank.toString(),l.string=s[c].name,g.string=s[c].score.toString(),r.active=!0,r.setPosition(0,-65*c)}var h=["Canvas/BG/項目/項目名稱/超能學習_排行_切換顏色_一般","Canvas/BG/項目/項目名稱/超能學習_排行_安全路徑_一般","Canvas/BG/項目/項目名稱/超能學習_排行_點擊加法_一般","","Canvas/BG/項目/項目名稱/超能學習_排行_打破障礙_一般"],m=this.now_page-1;3==m&&(m=0);for(var u=0;u<h.length;u++){var p=t(h[u]);p.active=u==m}var C=["Canvas/BG/總排行_背景/排行_文字/排行_文字_切換顏色","Canvas/BG/總排行_背景/排行_文字/排行_文字_安全路徑","Canvas/BG/總排行_背景/排行_文字/排行_文字_點擊加法","Canvas/BG/總排行_背景/排行_文字/排行_文字_總排行","Canvas/BG/總排行_背景/排行_文字/排行_文字_打破障礙"];m=this.now_page-1;for(var G=0;G<C.length;G++){var B=t(C[G]);B.active=G==m}},e.go_GameHome=function(){v.playSound("UI_click"),c().emit(r.Go_GameHome)},e.update=function(){},n}(),h=null;e._RF.pop()}}}));

System.register("chunks:///_virtual/SpriteFrameManager.ts",["cc"],(function(e){"use strict";var r,a,t,i;return{setters:[function(e){r=e.cclegacy,a=e.log,t=e.resources,i=e.SpriteFrame}],execute:function(){r._RF.push({},"67329MYlcNNOb09jn6hPEVi","SpriteFrameManager",void 0);var n=e("SpriteFrameManager",function(){function e(){}return e.init=function(){a("Init SpriteFrameManager !")},e.isLoadOk=function(){for(var r in e._cachedSpriteFrameMap)if(null==e._cachedSpriteFrameMap[r])return!1;return!0},e.preloadSpriteFrame=function(r){var a="img/"+r+"/spriteFrame";a in e._spriteName||(e._spriteName.push(a),e._cachedSpriteFrameMap[a]=null,t.load(a,i,(function(r,t){r?console.warn(r):e._cachedSpriteFrameMap[a]=t})))},e.getSpriteFrame=function(r){var a="img/"+r+"/spriteFrame";return e._cachedSpriteFrameMap[a]},e}());n._cachedSpriteFrameMap={},n._spriteName=[],r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=index.js.map